{"componentChunkName":"component---src-templates-post-tsx","path":"/SpringSecurity1/","result":{"data":{"markdownRemark":{"html":"<p>해당 포스팅은 정수원님의<br>\n<a href=\"https://www.inflearn.com/course/%EC%BD%94%EC%96%B4-%EC%8A%A4%ED%94%84%EB%A7%81-%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0/dashboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">스프링 시큐리티 - Spring Boot 기반으로 개발하는 Spring Security</a> 강의를 참고하여 작성했습니다.</p>\n<p>강의 예제는 <a href=\"https://github.com/spring-projects/spring-boot/releases/tag/v3.0.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">springboot starter 3.0.1</a>\n(security 6.0.1)을 사용해 진행</p>\n<!-- TODO: https://lelecoder.com/140 보고 필터 관련 글 써보자 -->\n<h1 id=\"용어-정리\" style=\"position:relative;\"><a href=\"#%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC\" aria-label=\"용어 정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>용어 정리</h1>\n<p>인증 : 어떤 개체(사용자 또는 장치)의 신원을 확인하는 과정<br>\n인가 : 어떤 개체가 어떤 리소스에 접근할 수 있는지 또는 어떤 동작을 수행할 수 있는지를 검증하는 것, 즉 접근 권한을 얻는 일</p>\n<h1 id=\"기본-api-및-filter\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8-api-%EB%B0%8F-filter\" aria-label=\"기본 api 및 filter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기본 API 및 Filter</h1>\n<h2 id=\"자동-구성-항목\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1-%ED%95%AD%EB%AA%A9\" aria-label=\"자동 구성 항목 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자동 구성 항목</h2>\n<p>Spring Security 의존성 추가 시 자동 구성</p>\n<ul>\n<li>모든 요청은 인증이 되어야 접근</li>\n<li>인증 방식 Form 로그인 방식 / httpBasic 로그인 방식 제공</li>\n<li>기본 로그인 페이지 제공 (기본 계정 : id : user / password 랜덤 문자열)</li>\n<li>CSRF 공격 방지</li>\n<li>세션 고정 보호</li>\n<li>보안 헤더 통합</li>\n</ul>\n<p>추가로 계정 추가, 권한 추가, DB연동 등 작업 필요</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token annotation punctuation\">@EnableWebSecurity</span> <span class=\"token comment\">// WebSecurity Configuration, Web보안 활성화</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SecurityConfig</span><span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SecurityFilterChain</span> <span class=\"token function\">filterChain</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpSecurity</span> http<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 인가 정책</span>\n        http\n                <span class=\"token punctuation\">.</span><span class=\"token function\">authorizeHttpRequests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>authz<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> authz <span class=\"token comment\">// 규칙 지정</span>\n                        <span class=\"token punctuation\">.</span><span class=\"token function\">anyRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">authenticated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 모든 요청이 인증을 요청하게 설정</span>\n                <span class=\"token punctuation\">)</span>\n                <span class=\"token comment\">// 인증 정책</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">formLogin</span><span class=\"token punctuation\">(</span><span class=\"token function\">withDefaults</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/authorize-http-requests.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http요청 승인</a></p>\n<p>설정하고 서버를 실행하면 user계정의 password가 실행 마다 변경되면서 console창에 노출이 되는데</p>\n<p>application.properties파일에 이를 명시할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">spring.security.user.name=user\nspring.security.user.password=1111</code></pre></div>\n<h2 id=\"login-form-인증-과정\" style=\"position:relative;\"><a href=\"#login-form-%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\" aria-label=\"login form 인증 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Login Form 인증 과정</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/340459b8a72e8ea8b21ca2da5bb4ad7d/8963a/loginFormProccess.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.05405405405406%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADjElEQVQ4y1WUyXIbVRRA8wMsEOUobqm71ZO6pbQka2wNnid5SJzyULFxLGRZlh0XGcumqAqQgCInHgKhEkLWrGETqqhiwQ/wA1my4zsOT+0kyIvbt/pVv/POffe9vhCOGEiKhh6N4VWGqIyOUx6fojxRxU3nkPUosmaiWQ7O5QTTJYeFYYerw3FmylHmyiZeUqNfMeiyLnQfIVVHNaLYThxLkZGXWki3jlAdF7lfQjNtImaM6vQ4L/cKvGnP8NvDKr8+nOaPzgwHyw6fSJpYWABDahdooER0QgMl+goTaFPLGHPrBItTSMUJlGjch3YtZMMW5lkmpmeEdcyvLCyqkBS9x1CUFJZCJL96zdW//mXhzVsWf3/L8p//4P3yN3J2EFk1KWVs9pds7i65PLiR44u1DPsrCXbmo+iGhqT2GMoCbJdGccbmSS2sk1lpYI9dwRqaJiIMJQGcHMrx5XqOg/Ui91dz3FpMcf96jq25y0S0c0AdRWhHdBOpr4+++TqBVhs5Kj6UFbF/NqbYX29wlHi2QiI/RDTl8bFk+BEInUmFew270IjpYLspnFRWTCqhCTPdjvsd7jat2+1ozMUUY5lcQYzbYt90f/w9wwe+73RI5EQmj1ceJFsoEgiGCIYjfikhVXRRVRnIZMjmc0xOieYZAiTLhBVF2Gnnj01Yt9lbLvDNRpoHGzm+ruX5tlHm0aZHwnWYHUlz0vJ4VMvwXT1Pu56js+XRbhQ4vTlIayFFUP4AFHTd4d6KmNRwOaynRCT9eLwRI5lwmB92eVbTOd50Od1KciLySSPByVaK7+sWrRmNoGL1ADWbO6slnjYLYlWPTrNMe1NY1gYEME61HKO9EuLJdpGn2x5HIh+1ShztVOh8qvHZWIhLavQdUFw9xXK5NxvkZdPi57tDvLpd4tXneR5f+4hUwmZuMMbRatC3etYUVq2Mn7vGx2v9NCfFfis9QNWKszYZ4851j4OtK+w35tmvV2lWTWJxce0qMTo3bGFepNPIcygqOWx6HLYqPKm71CZULnVL7j02F8UKgZBJoD8iQiMg6fTJUYKqzbWROC92UjzfK/F8NyciLyzT/LDr8dPNNDuz7/bwf6Bxdqb8c2V8CCXS/dBgcTLLj3tljnfKfldPdyscbxf89xe3R9hdSHJRNs4Dz8PPrLuH1hJ/HTeVZiA9gJtMiHtrYJgmhmWdZdMQPw/Ln/MfIwkY7eMLpXQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"loginFormProccess\"\n        title=\"loginFormProccess\"\n        src=\"/static/340459b8a72e8ea8b21ca2da5bb4ad7d/fcda8/loginFormProccess.png\"\n        srcset=\"/static/340459b8a72e8ea8b21ca2da5bb4ad7d/12f09/loginFormProccess.png 148w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/e4a3f/loginFormProccess.png 295w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/fcda8/loginFormProccess.png 590w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/efc66/loginFormProccess.png 885w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/c83ae/loginFormProccess.png 1180w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/8963a/loginFormProccess.png 1918w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li><strong>UsernamePasswordAuthenticationFilter</strong> 에서 요청 ID, Password를 통해 Token을 생성한다</li>\n<li>생성한 token을 <strong>AuthenticationManager</strong>에서 확인한다.</li>\n<li>실패 시\n3.1) <a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SecurityContextHolder</a>에서 인증 정보가 지워진다.<br>\n3.2) <a href=\"https://docs.spring.io/spring-security/site/docs/6.0.1/api/org/springframework/security/web/authentication/RememberMeServices.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RememberMeServices.loginFail</a>이 호출된다.<br>\n3.3) SecurityConfig에서 설정한 <strong>AuthenticationFailureHandler</strong>가 호출 된다.</li>\n<li>성공 시<br>\n4.1) <strong>SessionAuthenticationStrategy</strong>에 새로운 로그인을 알린다.<br>\n4.2)<a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SecurityContextHolder</a>에 인증정보 저장<br>\n4.3) ApplicationEventPublisher 생성<br>\n4.4) SecurityConfig에서 설정한 <strong>AuthenticationSuccessHandler</strong>가 호출 된다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">http\n        <span class=\"token punctuation\">.</span><span class=\"token function\">formLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// form 로그인 인증 기능 적용</span>\n<span class=\"token comment\">//                .loginPage(\"/loginPage\")</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">defaultSuccessUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">failureUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">usernameParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">passwordParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">loginProcessingUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login_proc\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">successHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthenticationSuccessHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 요청, 응답, 인증 객체</span>\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onAuthenticationSuccess</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Authentication</span> authentication<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>authentication<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                response<span class=\"token punctuation\">.</span><span class=\"token function\">sendRedirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">failureHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthenticationFailureHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onAuthenticationFailure</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">AuthenticationException</span> exception<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">{</span>\n\n                response<span class=\"token punctuation\">.</span><span class=\"token function\">sendRedirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">permitAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"logout과정\" style=\"position:relative;\"><a href=\"#logout%EA%B3%BC%EC%A0%95\" aria-label=\"logout과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logout과정</h2>\n<ol>\n<li>HTTP 세션 무효화</li>\n<li>구성된 모든 RememberMe 인증 정리</li>\n<li>SecurityContextHolder.clearContext()</li>\n<li>리다이렉션</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">http\n        <span class=\"token punctuation\">.</span><span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">logoutUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/logout\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">logoutSuccessUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"login\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addLogoutHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">LogoutHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> authentication authentication<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">HttpSession</span> session <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                session<span class=\"token punctuation\">.</span><span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">logoutSuccessHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">LogoutSuccessHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onLogoutSuccess</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Authentication</span> authentication<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">{</span>\n                    response<span class=\"token punctuation\">.</span><span class=\"token function\">sendRedirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">deleteCookies</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"remember-me\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/logout.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring security logout</a></p>\n<h2 id=\"rememberme-인증-영구-로그인-인증\" style=\"position:relative;\"><a href=\"#rememberme-%EC%9D%B8%EC%A6%9D-%EC%98%81%EA%B5%AC-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%9D%B8%EC%A6%9D\" aria-label=\"rememberme 인증 영구 로그인 인증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RememberMe 인증 (영구 로그인 인증)</h2>\n<blockquote>\n<p><strong>토근 기반 인증</strong>을 사용해 세션이 만료되고 웹 브라우저가 종료된 후에도 App이 사용자를 기억하는 기능</p>\n</blockquote>\n<p>Spring Security는 2가지 방법 제공</p>\n<ul>\n<li>\n<ol>\n<li>해싱을 사용하여 쿠키 기반 토큰의 보안 유지 기능 (보통 14일)</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>DB / 기타 영구 저장 매커니즘을 사용해 생성된 토큰 저장</li>\n</ol>\n</li>\n</ul>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/rememberme.html#remember-me-persistent-token\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">영구 저장 토큰 방식</a></p>\n<h3 id=\"인증-과정\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\" aria-label=\"인증 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 과정</h3>\n<ol>\n<li>세션이 만료 되었거나, Security Context에 인증 정보가 없는 경우(인증 객체가 Null인 경우) <strong>RememberMeAuthenticationFilter</strong>가 탐지</li>\n<li>Token 일치 여부 -> User계정 확인 -> 새로운 Authentication 생성</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">http\n  <span class=\"token punctuation\">.</span><span class=\"token function\">rememberMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">rememberMeParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"remember\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 파라미터 변경 / 기본 파라미터 명은 remember-me</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">tokenValiditySeconds</span><span class=\"token punctuation\">(</span><span class=\"token number\">3600</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// remeberme 시간 설정 가능 / default(14)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">alwaysRemember</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 기능이 활성화 되지 않아도 항상 리하는 것 여부 / default false</span>\n  <span class=\"token function\">userDetailsService</span><span class=\"token punctuation\">(</span>userDetailsService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 사용자 계정을 조회하는 과정 (필수로 설정 해야한다)</span></code></pre></div>\n<h3 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h3>\n<ul>\n<li>Remember Me기능 사용 시, 스프링 시큐리티는 인증 객체 관련 정보를 Remember Me 쿠키에 저장한 후 사용자에게 전달</li>\n<li>Remember Me 쿠키가 유효하면 JSESSIONID가 없어도 Remember Me 쿠키를 통해 로그인 처리</li>\n</ul>\n<h2 id=\"익명사용자-필터\" style=\"position:relative;\"><a href=\"#%EC%9D%B5%EB%AA%85%EC%82%AC%EC%9A%A9%EC%9E%90-%ED%95%84%ED%84%B0\" aria-label=\"익명사용자 필터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>익명사용자 필터</h2>\n<blockquote>\n<p>AnonymousAuthenticationFilter가 처리 하는데, 익명 사용자와 인증 사용자를 구분해서 처리하기 위한 용도</p>\n</blockquote>\n<ul>\n<li>화면에서 인증 여부를 구현할 때 isAnonymous()와 isAuthenticated()로 구분해서 사용</li>\n<li>인증 객체를 세션에 저장하지 않는다.</li>\n<li>사용자가 인증을 받지 않았으면 인증되지 않은 사용자의 토큰을 만들어 인증된 사용자와 구분하기 위한 용도</li>\n</ul>\n<h2 id=\"동시-세션-제어\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%8B%9C-%EC%84%B8%EC%85%98-%EC%A0%9C%EC%96%B4\" aria-label=\"동시 세션 제어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>동시 세션 제어</h2>\n<blockquote>\n<p>동일한 계정으로 접속했을 때 만들어지는 세션을 제어하는 방법</p>\n</blockquote>\n<ol>\n<li>\n<p>이전 사용자 세션 만료</p>\n<blockquote>\n<p>동일 계정으로 누군가 로그인 했을 때, 이전에 사용하던 사용자의 세션을 만료</p>\n</blockquote>\n</li>\n<li>\n<p>현재 사용자 인증 실패</p>\n<blockquote>\n<p>이미 동일 계정으로 접속하고 있는 사람이 있을 경우, 현재 인증 요청한 사용자의 인증 과정에서 인증 예외 처리</p>\n</blockquote>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 동시 세션 제어</span>\nhttp\n        <span class=\"token punctuation\">.</span><span class=\"token function\">sessionManagement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">maximumSessions</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>                 <span class=\"token comment\">// 최대 허용 가능 세션 수 (1) , -1 -> 무제한 로그인 세션 허용</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">maxSessionsPreventsLogin</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">// true : 현재 사용자 인증 실패, false : 기존 사용자 인증 실패</span>\n<span class=\"token comment\">//      .invalidSessionUrl(\"/invalid\")      // 세션이 유효하지 않을 경우 이동 할 페이지</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">expiredUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/expired\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">// 세션이 만료 된 경우 이동 할 페이지</span></code></pre></div>\n<h2 id=\"세션-고정-보호\" style=\"position:relative;\"><a href=\"#%EC%84%B8%EC%85%98-%EA%B3%A0%EC%A0%95-%EB%B3%B4%ED%98%B8\" aria-label=\"세션 고정 보호 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>세션 고정 보호</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 세션 고정 보호</span>\nhttp\n        <span class=\"token punctuation\">.</span><span class=\"token function\">sessionManagement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">// 세션 관리 설정 모드 사용.</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">sessionFixation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">changeSessionId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 기존 사용자의 세션에 Session ID만 변경</span>\n<span class=\"token comment\">//          .none();            //세션 고정 보호를 하지 않음.</span>\n<span class=\"token comment\">//          .newSession()       // 인증 성공 시 새로운 세션 사용</span></code></pre></div>\n<h2 id=\"세션-정책\" style=\"position:relative;\"><a href=\"#%EC%84%B8%EC%85%98-%EC%A0%95%EC%B1%85\" aria-label=\"세션 정책 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>세션 정책</h2>\n<blockquote>\n<p>세션 생성, 사용 여부를 설정 가능 (ALWAYS, IF_REQUIRED, NEVER, STATELESS)</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 세션 정책</span>\nhttp\n        <span class=\"token punctuation\">.</span><span class=\"token function\">sessionManagement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//      .sessionCreationPolicy(SessionCreationPolicy.ALWAYS);     // Spring Security가 항상 세션 설정</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">sessionCreationPolicy</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SessionCreationPolicy</span><span class=\"token punctuation\">.</span><span class=\"token constant\">IF_REQUIRED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 필요 시 생성(default)</span>\n<span class=\"token comment\">//      .sessionCreationPolicy(SessionCreationPolicy.NEVER);      // 생성x, 존재하면 사용</span>\n<span class=\"token comment\">//      .sessionCreationPolicy(SessionCreationPolicy.STATELESS);  // 생성x, 존재해도 사용x (JWT 사용 시)</span></code></pre></div>\n<h2 id=\"sessionmanagementfilter-concurrentsessionfilter\" style=\"position:relative;\"><a href=\"#sessionmanagementfilter-concurrentsessionfilter\" aria-label=\"sessionmanagementfilter concurrentsessionfilter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SessionManagementFilter, ConcurrentSessionFilter</h2>\n<p>SessionManagementFilter는</p>\n<ul>\n<li>동시 세션 제어</li>\n<li>세션 고정 보호</li>\n<li>세션 관리</li>\n<li>세션 생성 정책 설정</li>\n</ul>\n<p>4가지 기능을 수행하는데 동시 세션을 관리하는데 있어서 ConcurrentSessionFilter의 도움을 받는다.</p>\n<p><strong>사용자 요청이 들어올 때 마다, ConcurrentSessionFilter를 통해 매번 세션이 만료되었는지 확인</strong>\n-> 만료 되었으면 <strong>1. 로그아웃, 2. 세션 만료를 사용자에게 알림</strong></p>\n<h2 id=\"권한-설정과-표현식\" style=\"position:relative;\"><a href=\"#%EA%B6%8C%ED%95%9C-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%91%9C%ED%98%84%EC%8B%9D\" aria-label=\"권한 설정과 표현식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>권한 설정과 표현식</h2>\n<blockquote>\n<p>URL과 Method에 대해 권한 설정</p>\n</blockquote>\n<h3 id=\"선언적-방식\" style=\"position:relative;\"><a href=\"#%EC%84%A0%EC%96%B8%EC%A0%81-%EB%B0%A9%EC%8B%9D\" aria-label=\"선언적 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>선언적 방식</h3>\n<blockquote>\n<p>URL과 Method 방식 존재</p>\n</blockquote>\n<h4 id=\"1-url\" style=\"position:relative;\"><a href=\"#1-url\" aria-label=\"1 url permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. URL</h4>\n<blockquote>\n<p>HttpSecurity 객체를 사용해 설정</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">http\n    <span class=\"token punctuation\">.</span><span class=\"token function\">requestMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/users/**\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"USER\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<details>\n<summary><b>Http 객체 설정 (Toggle)</b></summary>\n<table>\n<thead>\n<tr>\n<th>Method</th>\n<th>Describe</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>hasRole(String)</td>\n<td>사용자가 주어진 역할이 있다면 접근 허용</td>\n</tr>\n<tr>\n<td>hasAuthority(String)</td>\n<td>사용자가 주어진 권한이 있다면 접근 허용 ex) hasAuthority('read')</td>\n</tr>\n<tr>\n<td>hasAnyRole(String...,)</td>\n<td>사용자가 주어진 권한이 있다면 접근 허용. (하나라도 있으면 , 로 구분)</td>\n</tr>\n<tr>\n<td>hasAnyAuthority(String...)</td>\n<td>사용자가 주어진 권한 중 어떤 것이라도 있따면 접근 허용</td>\n</tr>\n<tr>\n<td>hasIpAddress(String)</td>\n<td>주어진 IP로부터 요청이 온 경우 접근 허용</td>\n</tr>\n<tr>\n<td>permitAll()</td>\n<td>모든 요청 허용</td>\n</tr>\n<tr>\n<td>denyAll()</td>\n<td>모든 요청 접근 차단</td>\n</tr>\n<tr>\n<td>isAuthenticated()</td>\n<td>로그인 인증을 받은 사용자는 권한에 관계 없이 허용, 익명 사용자는 로그인 페이지로 이동</td>\n</tr>\n<tr>\n<td>isFullyAuthenticated()</td>\n<td>자동 로그인하지 않고 로그인 인증을 한 사용자는 권한에 관계 없이 허용</td>\n</tr>\n<tr>\n<td>isAnonymous()</td>\n<td>권한이 없는 익명의 사용자만 접근을 허용함 (로그인되어 권한이 있으면 접근 불가)</td>\n</tr>\n<tr>\n<td>isRememberMe()</td>\n<td>자동 로그인 대상 사용자의 경우 접근을 허용</td>\n</tr>\n</tbody>\n</table>\n</details>\n</br>\n<h4 id=\"method\" style=\"position:relative;\"><a href=\"#method\" aria-label=\"method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Method</h4>\n<blockquote>\n<p>@Pre and @Post Annotations 어노테이션을 이용해 권한 설정</p>\n</blockquote>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/expression-based.html#_method_security_expressions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@Pre and @Post Annotations doc</a></p>\n<h3 id=\"2-동적-방식-db연동\" style=\"position:relative;\"><a href=\"#2-%EB%8F%99%EC%A0%81-%EB%B0%A9%EC%8B%9D-db%EC%97%B0%EB%8F%99\" aria-label=\"2 동적 방식 db연동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 동적 방식 (DB연동)</h3>\n<p>뒤에서 설명</p>\n<h3 id=\"주의-사항\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9D%98-%EC%82%AC%ED%95%AD\" aria-label=\"주의 사항 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주의 사항</h3>\n<ul>\n<li>경로 표현을 생략하는 경우 <strong>모든 요청은 인증을 받아야 접근 가능</strong></li>\n<li>구체적인 경로는 앞에 작성, 뒤로 갈 수록 큰 범위의 경로 설정</li>\n<li>하위 경로 표현 시 **로 표현</li>\n</ul>\n<h2 id=\"예외-처리-및-요청-캐시-필터\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%8F-%EC%9A%94%EC%B2%AD-%EC%BA%90%EC%8B%9C-%ED%95%84%ED%84%B0\" aria-label=\"예외 처리 및 요청 캐시 필터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예외 처리 및 요청 캐시 필터</h2>\n<blockquote>\n<p>에러 처리 기능은 <strong>ExceptionHandling()</strong>가 처리</p>\n</blockquote>\n<p>anthenticationEntry - 인증 예외 / accessDeniedHandler - 인가 예외</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SecurityFilterChain</span> <span class=\"token function\">filterChain</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpSecurity</span> http<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n        http\n                <span class=\"token punctuation\">.</span><span class=\"token function\">exceptionHandling</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">authenticationEntryPoint</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthenticationEntryPoint</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token annotation punctuation\">@Override</span>\n                    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">commence</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">AuthenticationException</span> authException<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">{</span>\n                        response<span class=\"token punctuation\">.</span><span class=\"token function\">sendRedirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">accessDeniedHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AccessDeniedHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token annotation punctuation\">@Override</span>\n                    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">AccessDeniedException</span> accessDeniedException<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">{</span>\n                        response<span class=\"token punctuation\">.</span><span class=\"token function\">sendRedirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"denied\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"csrf처리\" style=\"position:relative;\"><a href=\"#csrf%EC%B2%98%EB%A6%AC\" aria-label=\"csrf처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSRF처리</h2>\n<blockquote>\n<p>Spring Security는 기본적으로 CSRF 사용 설정이 되어있으며, X-CSRF-TOKEN값을 헤더에 추가한다</p>\n</blockquote>\n<p>view template, Spring form 태그 사용 시 csrf토큰이 자동으로 설정</p>\n<p>기본적인 폼태그 사용할 땐 _csrf 값으로 추가</p>\n<h1 id=\"주요-아키텍처\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\" aria-label=\"주요 아키텍처 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 아키텍처</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/20e367d35b8dc6d9ce15855ecfccf33a/70d4c/DelegatingFilterAndFilterChainProxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.567567567567565%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB3ElEQVQoz11STWsaURT1b3Rd6LbQXVfabrPub3DhH5goSITSlnbnorrookGiQoPFItJkWQQX1Uk7xoYm8VsTZhzHGTszb75P5z0zSciFwzuce97HvffFTNOEYRgMuq4zUE71+7AsC47jMFCPoijQNA3r9fqWU18MYSihKAg99Pt/cDkYMM7zPFRVRRS2bbONVBMEAd1uN/T30ev10Ol0MJlMmC8WBEG4BDD+aZhPx5iOh1AVGa5jw/U8bPNAvV4Hx3FIp9MolUpMi3JR+L6/faHtAaIOnC809McyFqoP4t8ZZVlGrVZDuVxmqFarWK1WN4fe+egFMd9UcfJ3jt33n/A6v493Hw/AvS3i8KjNerLZbCBJEpLJJBKJBOLxOFKpFNMtYkPaXOP411c0+S+YK8PwhWSNH/wFnjxL4PnLHbzYeYVHj5/iTf4zu5UOYzabIZPJIJfLIZvNMiyXS/hugIF0hnxzDx++cThd/NyWLGoOjoUVvp9co9m9wtFvGWdX5m0po9EIxWIR7XYbrVYLhUIBoiiynOu7IJ4B4upwPDsaCuA5FqaTIYaX52xAUZNp0C9Bh0J7V6lU0Gg0QAi5adyDHtKSaNI0SbharETKTUKYTkG1+xOlPNr3EP8BedGD5+fu6w0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DelegatingFilterAndFilterChainProxy\"\n        title=\"DelegatingFilterAndFilterChainProxy\"\n        src=\"/static/20e367d35b8dc6d9ce15855ecfccf33a/fcda8/DelegatingFilterAndFilterChainProxy.png\"\n        srcset=\"/static/20e367d35b8dc6d9ce15855ecfccf33a/12f09/DelegatingFilterAndFilterChainProxy.png 148w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/e4a3f/DelegatingFilterAndFilterChainProxy.png 295w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/fcda8/DelegatingFilterAndFilterChainProxy.png 590w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/efc66/DelegatingFilterAndFilterChainProxy.png 885w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/c83ae/DelegatingFilterAndFilterChainProxy.png 1180w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/70d4c/DelegatingFilterAndFilterChainProxy.png 2548w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4 id=\"servlet-container\" style=\"position:relative;\"><a href=\"#servlet-container\" aria-label=\"servlet container permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Servlet Container</h4>\n<ul>\n<li>SecurityFilterAutoConfiguration에서 springSecurityFilterChain을 가져올 수 있게 DelegatingFilterProxy가 생성</li>\n</ul>\n<h4 id=\"spring-container\" style=\"position:relative;\"><a href=\"#spring-container\" aria-label=\"spring container permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring Container</h4>\n<ul>\n<li>WebSecurityConfiguration 클래스에서 WebSecurity 클래스가 springSecurityFilterChain이름으로 생성된 Bean들을 FilterChainProxy로 생성시켜 준다.</li>\n</ul>\n<p><strong>모든 요청은 DelegatingFilterProxy에서 시작</strong></p>\n<h2 id=\"delegatingfilterproxy\" style=\"position:relative;\"><a href=\"#delegatingfilterproxy\" aria-label=\"delegatingfilterproxy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DelegatingFilterProxy</h2>\n<p>Filter는 Servlet 2.3에서 부터 제공되는 기술로<br>\n<strong>서블렛을 통해 어떤 요청이 들어올 때 서블릿 자원에 들어오기 전에 처리</strong><br>\n즉, 요청에 대한 최종 접근 전, 후로 처리할 수 있게 하는 것이다.</p>\n<p>이 필터는 서블릿 스펙의 기술이며 Servlet 컨테이너에서 생성되고, 실행이 되기 때문에<br>\nSpring에서 만든 Bean을 Injection 해서 사용할 수 없다.</p>\n<p>Spring이 사용하는 기능을 사용하기 위해</p>\n<p><strong>DelegatingFilterProxy</strong>는 <strong>ApplicationContext</strong>에서<br>\n<strong>springSecurityFilterChain이름을 가진 스프링 빈(FilterChainProxy)을 찾아서 그 빈에게 요청을 위임</strong>한다</p>\n<h2 id=\"filterchainproxy\" style=\"position:relative;\"><a href=\"#filterchainproxy\" aria-label=\"filterchainproxy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FilterChainProxy</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4f6780b6c3149c5126721058e8552a30/6d2da/filterChainProxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABYUlEQVQ4y32T65KDIAyF+1p7URBUBLQzu3a3O33/98gmgShDtT8ywTL9OMlJLmO8wj1G+PMYYYFHXODuZ3DOQz8FGDBcmGHE+x5/c3hvMX+oDt5bzbmMizIW1lnB5CYGUBg8D3z2nAlmBgef2kDbWc6nQG17+I4K3JiAlnJWx9ntUFJK38oOLxQyUIMnhT6VKLFBUKnuR2hNz5ASVENZ4YoKfS6ZIBJdhjRY5lujDhU9AXeFHuzkU998Alt8pP6TKCyVlvcItPC7aAhiivQvw6WPFNJfepDOpyV/hWQKjYMZ3QZiAJ7HkEamQXfPFMqZS/6ZSSG9TL3bx2UQk3ILqKfUTwpymvJhD1fs4UJlMiAPdOW4QB2qpTPNJUFPgAqBnkvegDnEJCndxZmdL12vSrZww02J1L/CgNoQWb22KvNQ4Q1LvpYrl4Hl+smWnI3L0xwKMJmyl8o9w++mMy93WOIf7v/1OovmunEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"filterChainProxy\"\n        title=\"filterChainProxy\"\n        src=\"/static/4f6780b6c3149c5126721058e8552a30/fcda8/filterChainProxy.png\"\n        srcset=\"/static/4f6780b6c3149c5126721058e8552a30/12f09/filterChainProxy.png 148w,\n/static/4f6780b6c3149c5126721058e8552a30/e4a3f/filterChainProxy.png 295w,\n/static/4f6780b6c3149c5126721058e8552a30/fcda8/filterChainProxy.png 590w,\n/static/4f6780b6c3149c5126721058e8552a30/efc66/filterChainProxy.png 885w,\n/static/4f6780b6c3149c5126721058e8552a30/6d2da/filterChainProxy.png 936w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>springSecurityFilterChain의 이름으로 생성되는 필터 빈</li>\n<li>DelegatingFilterProxy로 부터 요청을 위임받고 실제 보안 처리</li>\n<li>SpringSecurity 초기화 시 생성되는 필터들을 관리하고 제어</li>\n<li>사용자 요청을 필터 순서대로 호출하여 전달</li>\n<li>모든 Filter를 통과 시 보안 처리 완료</li>\n</ol>\n<h2 id=\"filter-초기화-다중-보안-설정\" style=\"position:relative;\"><a href=\"#filter-%EC%B4%88%EA%B8%B0%ED%99%94-%EB%8B%A4%EC%A4%91-%EB%B3%B4%EC%95%88-%EC%84%A4%EC%A0%95\" aria-label=\"filter 초기화 다중 보안 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Filter 초기화 다중 보안 설정</h2>\n<blockquote>\n<p>여러개의 SecurityFilterChain 클래스를 만들어 url에 따라 다른 보안 정책이 적용될 수 있게 설정하면 WebSecurity에서 FilterChainProxy가 만들어 질 때 url에 따라 다른 정책이 적용될 수 있게 filter chain이 생성된다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token annotation punctuation\">@Order</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SecurityFilterChain</span> <span class=\"token function\">apiFilterChain</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpSecurity</span> http<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        http\n                <span class=\"token punctuation\">.</span><span class=\"token function\">securityMatcher</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/api/**\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">authorizeHttpRequests</span><span class=\"token punctuation\">(</span>authorize <span class=\"token operator\">-></span> authorize\n                        <span class=\"token punctuation\">.</span><span class=\"token function\">anyRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ADMIN\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">httpBasic</span><span class=\"token punctuation\">(</span><span class=\"token function\">withDefaults</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SecurityFilterChain</span> <span class=\"token function\">filterChain</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpSecurity</span> http<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/72a7742ec283e06fa237948fd5886ea2/f4fb1/securityFilterChains.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.243243243243242%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAp0lEQVQY042OvQ7CQAyD+zQgMVRdEIK20PtNLnd0QAy8/4uYXAsdEcMnx5ZiuTkawWkSHKeE9spob4xO785kHEbC7uw39pdK+Ekj7PGQhDtlhJhgSGAVxwU2FTi5w+d5RWYMjjDYiPGjvQ2arb5X3+Rk8cwJmQXMCTEJSPKiFc5l4ettILhIm7rIcMTLbYIWiha+CmPWhbXQa3GUAk+6Vp+q1mw07i/evfKOWAQdJzIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"securityFilterChains\"\n        title=\"securityFilterChains\"\n        src=\"/static/72a7742ec283e06fa237948fd5886ea2/fcda8/securityFilterChains.png\"\n        srcset=\"/static/72a7742ec283e06fa237948fd5886ea2/12f09/securityFilterChains.png 148w,\n/static/72a7742ec283e06fa237948fd5886ea2/e4a3f/securityFilterChains.png 295w,\n/static/72a7742ec283e06fa237948fd5886ea2/fcda8/securityFilterChains.png 590w,\n/static/72a7742ec283e06fa237948fd5886ea2/efc66/securityFilterChains.png 885w,\n/static/72a7742ec283e06fa237948fd5886ea2/c83ae/securityFilterChains.png 1180w,\n/static/72a7742ec283e06fa237948fd5886ea2/f4fb1/securityFilterChains.png 1766w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/configuration/java.html#_multiple_httpsecurity_instances\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">multiple-httpsecurity- instances - Spring Security Doc</a></p>\n<h2 id=\"인증authentication\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9Dauthentication\" aria-label=\"인증authentication permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증(Authentication)</h2>\n<blockquote>\n<p>어떤 개체(사용자 또는 장치)의 신원을 확인하는 과정</p>\n</blockquote>\n<p><a href=\"#login-form-%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\">인증 흐름</a>과 같이 진행이 되고 생성되는 Authentication Token의 구조를 살펴보면</p>\n<ol>\n<li>principal : 사용자 ID 또는 User객체</li>\n<li>credentials : 사용자 비밀번호, 대부분의 경우에 인증된 후 값이 지워져서 유출되지 않는다.</li>\n<li>authorities : 인증된 사용자의 권한 목록</li>\n<li>details : 인증 부가 정보</li>\n<li>Authenticated : 인증 여부</li>\n</ol>\n<p>로 이루어져 있다.</p>\n<p>AuthenticationManager의 구현체 ProviderManager가 인증 처리</p>\n<h3 id=\"securitycontext\" style=\"position:relative;\"><a href=\"#securitycontext\" aria-label=\"securitycontext permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityContext</h3>\n<blockquote>\n<p>필요 시 언제든지 Authentication 객체를 꺼내 쓸 수 있게 저장되는 저장소</p>\n</blockquote>\n<ul>\n<li>ThreadLocal에 저장되어 아무 곳에서나 참조 가능</li>\n<li>인증 완료 시, Httpsession에 저장 (App내 전역적인 참조 가능)</li>\n</ul>\n<h3 id=\"securitycontextholder\" style=\"position:relative;\"><a href=\"#securitycontextholder\" aria-label=\"securitycontextholder permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityContextHolder</h3>\n<blockquote>\n<p>SecurityContext를 감싸고 있는 wrapper 클래스</p>\n</blockquote>\n<ul>\n<li>\n<p>SecurityContext객체 저장 방식</p>\n<ul>\n<li>MODE_THREADLOCAL : 스레드 당 SecurityContext 객체 할당 (default)</li>\n<li>MODE_INHERITABLETHREADLOCAL : 메인 스레드와 자식 스레드에 관하여 동일한 SecurityContext를 유지</li>\n<li>MODE_GLOBAL : 응용 프로그램에서 단 하나의 SecurityContext저장 (static 변수로)</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/088166de4a83f6231408e6dc2f191e99/95be1/SecurityContextHolderFlow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.21621621621622%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABoklEQVQoz11S3U7iQBjto/ICXHODPsE+wXrDDUYvSFaBTRRBIrs1GBTbGCO2GpFUI0JLZzrTX3J2vvE32+TkfO1Mz3e+M2NEUQQhBIjfwJHGKe68CeoHW2gOd9A628XesI7x/SkStSal/MTHv8QE40voC4KYMzAeImQrzBcvuqZmYRhisVhguVxq0H7+DqqNOI6RJAnSNEWWZbqOlAuRZLqjFBK+74MzDnoajQbK5TIqlQqq1Spms0dgnaFIhJpMOXRdF5ZlodvtolQqwTRNSKuPV/O37vgwncJxHO0mCAK0223UajUtvF1XMVg2BhMfv0Yermc+jPl8Ds/z4Cjh/WYTN5NbuOcmnNFfMMa0O9pDdVEUaLVa6PV6GI8v0e/3cTY6x6HlYfePi4tbD4aUMdZFpobJ9UipZLi0bdjXN1qMIqBYyC1FYqs1ctnpdBSOdLMilcjiCLFQGa7zGCcXHjZ+WvhRv8Km4uPhPSLmI1iF4Jx/glxSAxJOFed5rk/67UCEhpGoIKdPATqnLg4GV0r8EbPnFej7d7HvooSP9/9vyD8RBkdN5yF07wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SecurityContextHolderFlow\"\n        title=\"SecurityContextHolderFlow\"\n        src=\"/static/088166de4a83f6231408e6dc2f191e99/fcda8/SecurityContextHolderFlow.png\"\n        srcset=\"/static/088166de4a83f6231408e6dc2f191e99/12f09/SecurityContextHolderFlow.png 148w,\n/static/088166de4a83f6231408e6dc2f191e99/e4a3f/SecurityContextHolderFlow.png 295w,\n/static/088166de4a83f6231408e6dc2f191e99/fcda8/SecurityContextHolderFlow.png 590w,\n/static/088166de4a83f6231408e6dc2f191e99/efc66/SecurityContextHolderFlow.png 885w,\n/static/088166de4a83f6231408e6dc2f191e99/c83ae/SecurityContextHolderFlow.png 1180w,\n/static/088166de4a83f6231408e6dc2f191e99/95be1/SecurityContextHolderFlow.png 2574w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>ThreadLocal에 SecurityContextHolder를 담고 있다.</li>\n<li>HttpSession에 SPRING<em>SECURITY</em>CONTEXT이름으로 저장</li>\n</ul>\n<p>SecurityContextHolder에서 인증정보 가져오는 방법</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Authentication</span> authentication <span class=\"token operator\">=</span> <span class=\"token class-name\">SecurityContextHolder</span><span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAuthentication</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"securitypersistencefilter\" style=\"position:relative;\"><a href=\"#securitypersistencefilter\" aria-label=\"securitypersistencefilter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityPersistenceFilter</h3>\n<blockquote>\n<p>SecurityContext 객체의 생성, 저장, 조회</p>\n</blockquote>\n<h4 id=\"익명-사용자\" style=\"position:relative;\"><a href=\"#%EC%9D%B5%EB%AA%85-%EC%82%AC%EC%9A%A9%EC%9E%90\" aria-label=\"익명 사용자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>익명 사용자</h4>\n<ul>\n<li>새로운 SecurityContext 객체를 생성하여 SecurityContextHolder에 저장</li>\n<li>AnonymouseAuthenticationFilter에서 AnonymousAuthenticationToken 객체를 SecurityContext에 저장</li>\n</ul>\n<h4 id=\"인증-시\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%EC%8B%9C\" aria-label=\"인증 시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 시</h4>\n<ul>\n<li>새로운 SecurityContext객체를 생성하여 SecurityContextHolder에 저장</li>\n<li>UsernamePasswordAuthenticationFilter에서 인증 성공 후 SecurityContext 에 UsernamePasswordAuthentication 객체를 SecurityContext에 저장</li>\n<li>인증이 최종 완료되면 Session 에 SecurityContext를 저장</li>\n</ul>\n<h4 id=\"인증-후\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%ED%9B%84\" aria-label=\"인증 후 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 후</h4>\n<ul>\n<li>Session에서 SecurityContext 꺼내 SecurityContextHolder에서 저장</li>\n<li>SecurityContext안에 Authentication 객체가 존재하면 계속 인증을 유지</li>\n</ul>\n<h4 id=\"최종-응답-시-공통\" style=\"position:relative;\"><a href=\"#%EC%B5%9C%EC%A2%85-%EC%9D%91%EB%8B%B5-%EC%8B%9C-%EA%B3%B5%ED%86%B5\" aria-label=\"최종 응답 시 공통 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>최종 응답 시 공통</h4>\n<ul>\n<li>SecurityContextHolder안의 SecurityContext객체에서 보관하던 인증정보 반드시 초기화</li>\n<li>초기화 시 SecurityContextHolder.clearContext() 사용</li>\n</ul>\n<h4 id=\"securitypersistencefilter-flow\" style=\"position:relative;\"><a href=\"#securitypersistencefilter-flow\" aria-label=\"securitypersistencefilter flow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityPersistenceFilter Flow</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2b836417c87f4dff019efaf7c23d6dc0/66900/SecurityPersistenceFilter.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABx0lEQVQoz21RTW/aQBD1/z+0x/RUpVIubdRKqSqQolSkaYMTAy6FqLR8VEAA29jGH7troJfXfUsX5ZDDaGbfzLw3M+s8du6x+N7Gwm9h7jWx9D1E3g2i1leEdw1EHRcLjT/eNxGFa+RZijwNIfIEmfZFliCOExRFgXa7Def0vI6L5gRnn5p4e/UDn1tjrBrv8evjGwwvXmP6pYYPlz9xen6Ld/UHzB6usPRO0Km/0CKvEP6+xLdbF9fXDdRqNThpukEQRsiyHNV2h1JIVEpCihKVFIdYVihKAcHcbg+5dPHn5iVU4GG7+6vxEvv9Hv1+H44UQjdIM/J4PEK328V4MkG0XkMpharaaqtMjdLkjBWFZGa8lEoTCkPY6/U0oSmsDOFoNMJEkyVJgjzPjcVxjM1mg7IskeuaLMs0XphNKEiRZwiVaSBpEARHQsYUmU6nBlutVhgOh5jP57q+MFPb7Z4lJAmnoeckLKQxR3w2mxky61nDDfhe6xP5vg/ncKfKNEVRhDAMjxNaLE1TQ0ycMT2NmBUn7rouHCa4GhUGg4Exrsg3b0NBbkFyuw29+P+ZNndc2d6O3jaxmPHh6OpI8pTQxrSnn/IPQ73kgXhGJ4YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SecurityPersistenceFilter\"\n        title=\"SecurityPersistenceFilter\"\n        src=\"/static/2b836417c87f4dff019efaf7c23d6dc0/fcda8/SecurityPersistenceFilter.png\"\n        srcset=\"/static/2b836417c87f4dff019efaf7c23d6dc0/12f09/SecurityPersistenceFilter.png 148w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/e4a3f/SecurityPersistenceFilter.png 295w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/fcda8/SecurityPersistenceFilter.png 590w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/efc66/SecurityPersistenceFilter.png 885w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/c83ae/SecurityPersistenceFilter.png 1180w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/66900/SecurityPersistenceFilter.png 2630w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>FilterChainProxy에 2번째 위치하며 모든 요청에서 수행</li>\n<li>\n<p>내부적으로 HttpSecurityContextRepository가 SecurityContext객체 생성, 조회하는 역할을 하는 로직 수행<br>\na. 인증 전</p>\n<ul>\n<li>새로운 컨텍스트 생성 (SecurityContext는 null)</li>\n<li>인증 필터(AuthFilter)가 인증 처리</li>\n<li>인증객체(Authentication)생성 후 SecurityContext 객체안에 저장</li>\n<li>Session에 SecurityContext저장</li>\n</ul>\n<p>b. 인증 후</p>\n<ul>\n<li>Session에서 SecurityContext가 있는지 확인</li>\n<li>SecurityContext를 꺼내 SecurityContextHolder에 저장</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"인증-흐름-authentication-flow\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%ED%9D%90%EB%A6%84-authentication-flow\" aria-label=\"인증 흐름 authentication flow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 흐름 (Authentication Flow)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4e99efbbeb87c92808bb57ae18218616/9dbdb/AuthenticationFlow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABwklEQVQoz1VSTW/TQBT0/z9zQEjpoRckKAiEkHqhp7ZQkyZGlfJh4iRO6sTf9nq9dnKa7myzERye367e7My8SZz4zxDp0wjx8B7x+Dey8S+k3gPSx3tUzyFEI5EXJYqy0lVDNgKiKlDrkqLU9wZVVaGu9UxKOG/eDvD5xsPg6gcuvz8gGI8QfrvA06cB4puP+On6uPwywvuvQ3y4nmE7v8P+8R027gXK6RX++lPc3t7BdV1sNhs4cZIizQtk2kVZCa3SoJe616XpTdNqlwq10F12aDlvK3RSV/vqqtEu2Y3DLE0RRRGEEEjiGMvVCpW23yoF1XXoTCm0rYRSre5KP2S9npXirDWd5fBzOBxQFAXm8zlms6muGbIsM0Cq23yIY/V9Z8j7kyBnxLIce6DDsiwNMUPe7XbwPA+TyQTr9dpssVgssNLnMAyNYJIkiPVWfGtdngmp0vf9yUFvXC2XSwRBgFTHQjHf97EOFiYaClKAQsTa1R1aJgEveZ6fAXTKByTZbrfGBZ1H0bOJgXfiKfafQypxBTqwRBZMQv4ViCHJv3nareyGZ0Jmsd/vDbg7hWx/sePxeI7APuDcklmcJeb5Bdkx6jeuQ+7ZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AuthenticationFlow\"\n        title=\"AuthenticationFlow\"\n        src=\"/static/4e99efbbeb87c92808bb57ae18218616/fcda8/AuthenticationFlow.png\"\n        srcset=\"/static/4e99efbbeb87c92808bb57ae18218616/12f09/AuthenticationFlow.png 148w,\n/static/4e99efbbeb87c92808bb57ae18218616/e4a3f/AuthenticationFlow.png 295w,\n/static/4e99efbbeb87c92808bb57ae18218616/fcda8/AuthenticationFlow.png 590w,\n/static/4e99efbbeb87c92808bb57ae18218616/efc66/AuthenticationFlow.png 885w,\n/static/4e99efbbeb87c92808bb57ae18218616/c83ae/AuthenticationFlow.png 1180w,\n/static/4e99efbbeb87c92808bb57ae18218616/9dbdb/AuthenticationFlow.png 2622w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>UsernamePasswordAuthenticationFilter는 요청을 가로채서 Authentication(인증정보) 생성</li>\n<li>AuthenticationManager는 적절한 Provider를 찾아 인증 처리 위임</li>\n<li>AuthenticationProvider는 실제 ID/PW 인증 처리를 하는데 ID의 경우 UserDetailsService를 사용해 조회 -> 조회 한 UserDetails 정보로 PW 검증</li>\n<li>AuthenticationProvider는 인증 성공 후 유저정보(UserDetails) + 권한 정보(authorities) 담아 토큰 생성</li>\n<li>UsernamePasswordAuthenticationFilter가 인증 객체를 전달 받아 SecurityContext에 인증 정보 저장</li>\n</ol>\n<h3 id=\"authenticationmanager\" style=\"position:relative;\"><a href=\"#authenticationmanager\" aria-label=\"authenticationmanager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AuthenticationManager</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ecdd5b39cf65ef365af96f97b0b4196b/c658e/AuthenticationManager.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABrklEQVQoz22SfXPSQBDG8/2/hAyML7QqrdZpdZzRDq0MtjRQoSWAvJcQk5DXuxCo/rykI3ZG/3hmb+92n31297Q4jvkHQuzOMt2Qbu9zrBWETHZvIv1JuJyzbFUJ5BYhJNp/CbNgRZpIgVl7T+egQPtNkf5RkXDaQ6w3xFGEXI2JnCED4wpn2iKJV2hSsaYqYJM+IFEKMrJQJYiMeHKL2/nKXatG3LtC2AuiWBL4K+5nR4SdApb+hF/jFyRuD623aFP5UuLw/Dmvzko0huf4foBhGPywbapdh5fVHq+rXSq1EcbMxfdWhIGP13/HrFFirj/Daj1FugM0y1tg3H3jun/JrZI9d1QbUUwYhspGjEyPm5Gl3ud0Jw6m7Sl1PoEilLPPODcVrPYB0fe3SG+MZi6WNBtNTj98pFG/ZDKeIqXMF5PZ0XDARb1G9fQT7esmrmOr+yRXuJ2f4OhFZvUC6XCPZKUUep6HaZosLSu3ruvmM8w3rAh1XWdvf59yuczx8UkekyR/N50kgvVaqpwHX8uSsoA/yNU92nRWwFazzOA4jmo12BUUj75XHIvc/w198E3D4bX/vQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AuthenticationManager\"\n        title=\"AuthenticationManager\"\n        src=\"/static/ecdd5b39cf65ef365af96f97b0b4196b/fcda8/AuthenticationManager.png\"\n        srcset=\"/static/ecdd5b39cf65ef365af96f97b0b4196b/12f09/AuthenticationManager.png 148w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/e4a3f/AuthenticationManager.png 295w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/fcda8/AuthenticationManager.png 590w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/efc66/AuthenticationManager.png 885w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/c83ae/AuthenticationManager.png 1180w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/c658e/AuthenticationManager.png 2202w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>AuthenticationProvider 목록 중에서 인증 처리 요건에 맞는 AuthenticationProvider를 찾아 인증 처리 위임</p>\n</blockquote>\n<ul>\n<li>AuthenticationManager 는 인터페이스로 실제 구현체는 <strong>ProviderManager</strong></li>\n<li>ProviderManager에 인증 처리 요건에 맞는 것이 없을 경우 부모 ProviderManager에서 탐색 후 처리</li>\n</ul>\n<h3 id=\"authenticationprovider\" style=\"position:relative;\"><a href=\"#authenticationprovider\" aria-label=\"authenticationprovider permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AuthenticationProvider</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e42b0d3646ee4c1287683d3cdcb853eb/fb2bb/AuthenticationProvider.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB30lEQVQoz32SXW8SQRSG959xYeI9N/AH/FVeaKIXxlQvFJsUSMS2BKIulFpaSMrH7grFCvs1u7O73aU8zi7hxhgnefKezEzOzHvO0aSUhGH4f+KEeLvDlxGLxRIpIthCovaTJCHLsoI81g4Jcz0QR3FBFEVE8QNyZeJddQimQ4bjS+qdT3zRm1i/5piGSf+iz2AwwLIsNCEEB3x/r7azKXDsNY7nISY/mB+/wtVbTKwbap0jPrbfcj0bYMxNdF2n1+thmibabrcjJ81S2MG9u+Jd9yVHpy94f/qc85s63uSa2+PX/NY/s/y5oNv+ylnrHP2brtwFbLdbZTlVlmO0VqtFo9Gg2WxycnKCYcyRscDzbTxh4wY+cnbFXeMNYnCqSiERgXIjfEIZEgSSQOwJVaxVq1XK5TKVSoVSqUS93iBfYZIRp49ECrkycC7b2OM+ruPgqTK4rlsQxR5xsiePtfzQtm02G1Uz1yNw1oixjjfq4Y++Exgj5EOKHyUYizum02nhYjazlF6wMCtY06eYkyesls/Qik4q8lqEaizC9Yp1u8bdeY37sw+IYRepOh4GgbqnJiDed3+voWrcjM16orjFcQy0v2dO5g9kj8SKXPPfFWf/nFepkqbKarZHxX8AbPyTZXr00q4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AuthenticationProvider\"\n        title=\"AuthenticationProvider\"\n        src=\"/static/e42b0d3646ee4c1287683d3cdcb853eb/fcda8/AuthenticationProvider.png\"\n        srcset=\"/static/e42b0d3646ee4c1287683d3cdcb853eb/12f09/AuthenticationProvider.png 148w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/e4a3f/AuthenticationProvider.png 295w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/fcda8/AuthenticationProvider.png 590w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/efc66/AuthenticationProvider.png 885w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/c83ae/AuthenticationProvider.png 1180w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/fb2bb/AuthenticationProvider.png 3132w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>\n<p>AuthenticationProvider 는 인터페이스로 2개의 메서드 존재</p>\n<ul>\n<li>authenticate(authentication) : 실제적인 인증처리를 위한 검증 메서드</li>\n<li>supports(authentication): 인증처리가 가능한 Provider인지 검사하는 메서드</li>\n</ul>\n</li>\n<li>\n<p>아이디 검증</p>\n<ul>\n<li>존재 -> UserDetails 반환 / 존재 x -> UserNotFoundException</li>\n</ul>\n</li>\n<li>\n<p>패스워드 검증</p>\n<ul>\n<li>반환된 UserDetails에 저장된 password와 로그인시 입력한 패스워드(authentication.password)가 일치하는지 비교</li>\n<li>일치하지 않을 경우 BadCredentialException 발생</li>\n<li>일반적으로 패스워드를 저장할 때 Password Encoder를 이용해 암호화 하여 저장하기 때문에 해당 클래스(PasswordEncoder)를 이용해 두 암호를 비교</li>\n</ul>\n</li>\n<li>\n<p>추가 검증</p>\n<ul>\n<li>추가적으로 사용자가 정의한 검증 조건 검증</li>\n<li>검증이 모두 성공하면 최종적으로 인증객체를 생성 후 AuthenticationManager에 전달</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"인가authorization\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EA%B0%80authorization\" aria-label=\"인가authorization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인가(Authorization)</h2>\n<blockquote>\n<p>어떤 개체가 어떤 리소스에 접근할 수 있는지 접근 권한 할당</p>\n</blockquote>\n<h3 id=\"시큐리티가-지원하는-권한-계층\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0%EA%B0%80-%EC%A7%80%EC%9B%90%ED%95%98%EB%8A%94-%EA%B6%8C%ED%95%9C-%EA%B3%84%EC%B8%B5\" aria-label=\"시큐리티가 지원하는 권한 계층 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시큐리티가 지원하는 권한 계층</h3>\n<ul>\n<li>웹 계층 : URL요청에 따른 메뉴 혹은 화면단위의 레벨 보안</li>\n<li>서비스 계층 : 메소드 같은 기능 단위의 레벨 보안</li>\n<li>도메인 계층 : 객체 단위의 레벨 보안</li>\n</ul>\n<h3 id=\"authorizationfilter\" style=\"position:relative;\"><a href=\"#authorizationfilter\" aria-label=\"authorizationfilter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AuthorizationFilter</h3>\n<blockquote>\n<p>마지막에 위치한 필터로 승인, 거부를 최종적으로 결정</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3ca2220120829f65ea3761ed56dde342/37f8f/FilterSecurityInterceptor.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.94594594594595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB6ElEQVQoz3WSy08TURjF+5+6doULtyYk/hOuWBhNSHVhQAgaizFCEEozQwstlWmn82qHPub9buvPO2PasHFx7vkW557c851bi+KMyNVY2DK+oWKf1hmc7PNw9I7upz2C5heSMCBO1wgpSU7FcZwIxFtEUVRxrTzyPBcoSJKUYrnCD0K6vXtcwYnrEIYFM6VO/9szbr8+x7h4ge+OCcIY3/cIgkBowsq05nkemqah6zqO46KL+eJa5vzXFb/7fayxRRilJIs70skJgdUgn54S+AuyLKcocsEZ6/W64prruiiKgqqqwtCpZlmWaDavaLfbGOqQJAqZ+QWj6RLVTjAWa5EmYyTuSLJc6WTBpmk+jZxXO0izgrE9p3PbYzK2GSlDRgOF7mjK8eUDhz87fL/RSfMlH+p1dnZ22N3drbjRaPwzLPOPLRPdtDn+ofD+oMXHkzb7hxLnkoVh6AxVk2arR0u656aj8Pg4FXELVqtV9Zht5HKRm4ZK9vwIwxzT6XR5nLk40zmLhc9MP0eT3jCU9rDu3hJ4M1GG0IsOSmx8ak9rL5FlKQPN4Lol4ZRCzyGKl3jaZybNl2iXr5i3XxO4tkgWbxveeNSemqVJjDUPObrSODjrc9adEkTlfxMJ0j+kS8gEkuL///AvNl2T5iQ04yoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"FilterSecurityInterceptor\"\n        title=\"FilterSecurityInterceptor\"\n        src=\"/static/3ca2220120829f65ea3761ed56dde342/fcda8/FilterSecurityInterceptor.png\"\n        srcset=\"/static/3ca2220120829f65ea3761ed56dde342/12f09/FilterSecurityInterceptor.png 148w,\n/static/3ca2220120829f65ea3761ed56dde342/e4a3f/FilterSecurityInterceptor.png 295w,\n/static/3ca2220120829f65ea3761ed56dde342/fcda8/FilterSecurityInterceptor.png 590w,\n/static/3ca2220120829f65ea3761ed56dde342/efc66/FilterSecurityInterceptor.png 885w,\n/static/3ca2220120829f65ea3761ed56dde342/c83ae/FilterSecurityInterceptor.png 1180w,\n/static/3ca2220120829f65ea3761ed56dde342/37f8f/FilterSecurityInterceptor.png 3056w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>인증객체 없이 보호자원에 접근을 시도하면 AuthenticationException 발생</li>\n<li>인증 후 자원에 접근 가능한 권한이 존재하지 않을 경우 AccessDeniedException 을 발생</li>\n<li>HTTP 자원의 보안을 처리하는 필터 (URL방식으로 접근 할 경우 동작)</li>\n<li>권한 처리를 AccessDecisionManager에게 맡김</li>\n</ul>\n<h3 id=\"accessdecisionmanager\" style=\"position:relative;\"><a href=\"#accessdecisionmanager\" aria-label=\"accessdecisionmanager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AccessDecisionManager</h3>\n<blockquote>\n<p>인증,요청,권한 정보를 이용해서 사용자의 자원접근을 허용/거부 여부를 최종 결정하는 주체</p>\n</blockquote>\n<ul>\n<li>여러 개의 Voter들을 가질 수 있고, Voter들로부터 접근허용, 거부, 보류에 해당하는 각각의 값을 리턴받아 판단, 결정</li>\n</ul>\n<h4 id=\"접근결정의-세-가지-유형-구현체\" style=\"position:relative;\"><a href=\"#%EC%A0%91%EA%B7%BC%EA%B2%B0%EC%A0%95%EC%9D%98-%EC%84%B8-%EA%B0%80%EC%A7%80-%EC%9C%A0%ED%98%95-%EA%B5%AC%ED%98%84%EC%B2%B4\" aria-label=\"접근결정의 세 가지 유형 구현체 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>접근결정의 세 가지 유형 (구현체)</h4>\n<ol>\n<li>AffirmativeBased : OR 연산자와 같은 논리</li>\n<li>ConsensusBased : 다수결</li>\n<li>UnanimousBased : AND 연산자와 같은 논리</li>\n</ol>\n<p>권한 부여 과정에서 판단하는 값</p>\n<ul>\n<li>Authenticaion - 인증정보(user)</li>\n<li>FilterInvocator - 요청 정보(requestMatchers(\"/user\"))</li>\n<li>ConfigAttributes - 권한 정보(hasRole(\"USER\"))</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">http\n    <span class=\"token punctuation\">.</span><span class=\"token function\">authorizeHttpRequests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>authz<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> authz <span class=\"token comment\">// 규칙 지정</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">requestMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/user\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"USER\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">requestMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/pay\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ADMIN\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">requestMatchers</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/admin/**\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasAnyRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ADMIN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SYS\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">anyRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">authenticated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 모든 요청이 인증을 요청하게 설정</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"정리-1\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC-1\" aria-label=\"정리 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d48feaa6861a31f403be6c1613cc78b/e8950/flow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACZUlEQVQoz02SW08aURSF5yf21/ShadI3a4y2JooCvrQ1lsbE3pKqUUTkUnS4wzhcBLmJgzIMt2EoYPv1zCRN+rCS2fustc6afbbU6TxQvS0Qz/uJyt+pqHHum3fMZ08sfv1hZi0wega9ns54PMHQm1RVP/3uLUOjQaN0SFE5RqudY44HSNPxCOXe4GUoyfPjc04yZfp39xTbaY4S7wmrX+jqj8Kwx3A0QddUKvFN9HYKo6NQT73lJrlJW/EyHHSR+L1gsIBvyid88isqgzlza0p3fEe+HqXSSTOxTCYTi6fFjMfhjGCmiWZM0UdzQoUBAaVHvGpiib+SstkcCfmSnHxFIhIll0wgx2XRS6LmS2SSeeQrmUgkQiIR5yIc5dAfJHARJvwzxuHpOWcXEY7852RzeaT9/X2WlpZwezysrK7idnvY8e6wteXCJbC8/BqXy8Xa2hper5f19XV8H/fY2Nhgd/cDb9+IvseNe3sbn8+H1GjUSYhENzdlkSCBoihcX1+Tz+fJZDIibRxZlonFYk6dTIrkhYJTp0UdCoUIi/Q2J51OI6UzCif+MJdXKTqdDq1Wi2Aw6MAWpAQpLkxtYaPRQNd1isUiBwcHzhhUVaVULnN2dkYgEECKBj/z1beC/8c7ppZFv993xDZZ0zpoYq1sE9vMful2u+2chcNihmLmtrmtqVargq8hlWLrhHzPyJ6+wDTHpFIp9vb2nHlUKhWmszkjsX9j8cqjsYkudlJ7eMQYDHnUDecS0zSZTqcOpGZLQy3VuK23sUTCbrdLrVZzYCezJhNH8A82xxZORN/+tvH/+V9B1LRaQv+/9AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flow\"\n        title=\"flow\"\n        src=\"/static/3d48feaa6861a31f403be6c1613cc78b/fcda8/flow.png\"\n        srcset=\"/static/3d48feaa6861a31f403be6c1613cc78b/12f09/flow.png 148w,\n/static/3d48feaa6861a31f403be6c1613cc78b/e4a3f/flow.png 295w,\n/static/3d48feaa6861a31f403be6c1613cc78b/fcda8/flow.png 590w,\n/static/3d48feaa6861a31f403be6c1613cc78b/efc66/flow.png 885w,\n/static/3d48feaa6861a31f403be6c1613cc78b/c83ae/flow.png 1180w,\n/static/3d48feaa6861a31f403be6c1613cc78b/e8950/flow.png 2000w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"초기화\" style=\"position:relative;\"><a href=\"#%EC%B4%88%EA%B8%B0%ED%99%94\" aria-label=\"초기화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>초기화</h3>\n<ol>\n<li>Security가 초기화 될 때 Security Config 구성대로 생성 된 Filters를 <strong>WebSecurity가 FilterChainProxy 생성</strong> (springSecurityFilterChain 이름을 가진다)</li>\n<li><strong>DelegatingFilterProxy</strong>가 springSecurityFilterChain이름을 가진 <strong>FilterChainProxy를 찾아 요청을 위임</strong>한다.</li>\n</ol>\n<h3 id=\"인증\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D\" aria-label=\"인증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증</h3>\n<ol start=\"3\">\n<li><strong>SecurityPersistenceFilter</strong>가 SecurityContext가 있는지 확인 후, 없으면 <strong>Autehntication 객체 생성 후 SecurityContext에 저장</strong></li>\n<li>Logout 요청이 없는경우 특별한 동작 x</li>\n<li><strong>UsernamePasswordAuthenticationFilter</strong>에서 UserDetailsService로 <strong>ID, PW 검사 후 인증 정보를 더해 SecurityContext에 저장</strong></li>\n<li>인증 성공 시 뒤에있는 Session ManagementFilter 과정도 동시에 처리, <strong>동시 세션에 대한 처리</strong>한다</li>\n<li><strong>사용자가 정의한 SuccessHandler 작업 수행, 특정한 경로로 리다이렉트</strong></li>\n<li>다시 요청이 들어와서 SecurityContextPersistenceFilter가 ContextHolder에서 loadContext 후 진행</li>\n</ol>\n<p>ConcurrentSessionFilter ~ SessionManagementFilter는 해당사항이 있을 경우만 진행</p>\n<h3 id=\"인가\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EA%B0%80\" aria-label=\"인가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인가</h3>\n<ol start=\"9\">\n<li>ExceptionTranslationFilter로 감싸 FilterSecurityInterceptor 인가 필터가 인증 객체부터 검사</li>\n<li>AccessDecisionManager가 실행</li>\n</ol>\n<!-- # Form 인증\n\n# Ajax 인증\n\n# DB연동 -->\n<h1 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h1>\n<ul>\n<li><a href=\"https://dextto.tistory.com/234\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">인증(Authentication) vs. 인가(Authorization)</a></li>\n<li><a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Security Document</a></li>\n<li><a href=\"https://www.inflearn.com/course/%EC%BD%94%EC%96%B4-%EC%8A%A4%ED%94%84%EB%A7%81-%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0/dashboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">스프링 시큐리티 - Spring Boot 기반으로 개발하는 Spring Security</a></li>\n</ul>","excerpt":"해당 포스팅은 정수원님의 스프링 시큐리티 - Spring Boot 기반으로 개발하는 Spring Security 강의를 참고하여 작성했습니다. 강의 예제는 springboot starter 3.0.1\n(security 6.0.1)을 사용해 진행 용어…","tableOfContents":"<ul>\n<li><a href=\"/SpringSecurity1/#%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC\">용어 정리</a></li>\n<li>\n<p><a href=\"/SpringSecurity1/#%EA%B8%B0%EB%B3%B8-api-%EB%B0%8F-filter\">기본 API 및 Filter</a></p>\n<ul>\n<li><a href=\"/SpringSecurity1/#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1-%ED%95%AD%EB%AA%A9\">자동 구성 항목</a></li>\n<li><a href=\"/SpringSecurity1/#login-form-%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\">Login Form 인증 과정</a></li>\n<li><a href=\"/SpringSecurity1/#logout%EA%B3%BC%EC%A0%95\">Logout과정</a></li>\n<li>\n<p><a href=\"/SpringSecurity1/#rememberme-%EC%9D%B8%EC%A6%9D-%EC%98%81%EA%B5%AC-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%9D%B8%EC%A6%9D\">RememberMe 인증 (영구 로그인 인증)</a></p>\n<ul>\n<li><a href=\"/SpringSecurity1/#%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\">인증 과정</a></li>\n<li><a href=\"/SpringSecurity1/#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</li>\n<li><a href=\"/SpringSecurity1/#%EC%9D%B5%EB%AA%85%EC%82%AC%EC%9A%A9%EC%9E%90-%ED%95%84%ED%84%B0\">익명사용자 필터</a></li>\n<li><a href=\"/SpringSecurity1/#%EB%8F%99%EC%8B%9C-%EC%84%B8%EC%85%98-%EC%A0%9C%EC%96%B4\">동시 세션 제어</a></li>\n<li><a href=\"/SpringSecurity1/#%EC%84%B8%EC%85%98-%EA%B3%A0%EC%A0%95-%EB%B3%B4%ED%98%B8\">세션 고정 보호</a></li>\n<li><a href=\"/SpringSecurity1/#%EC%84%B8%EC%85%98-%EC%A0%95%EC%B1%85\">세션 정책</a></li>\n<li><a href=\"/SpringSecurity1/#sessionmanagementfilter-concurrentsessionfilter\">SessionManagementFilter, ConcurrentSessionFilter</a></li>\n<li>\n<p><a href=\"/SpringSecurity1/#%EA%B6%8C%ED%95%9C-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%91%9C%ED%98%84%EC%8B%9D\">권한 설정과 표현식</a></p>\n<ul>\n<li><a href=\"/SpringSecurity1/#%EC%84%A0%EC%96%B8%EC%A0%81-%EB%B0%A9%EC%8B%9D\">선언적 방식</a></li>\n<li><a href=\"/SpringSecurity1/#2-%EB%8F%99%EC%A0%81-%EB%B0%A9%EC%8B%9D-db%EC%97%B0%EB%8F%99\">2. 동적 방식 (DB연동)</a></li>\n<li><a href=\"/SpringSecurity1/#%EC%A3%BC%EC%9D%98-%EC%82%AC%ED%95%AD\">주의 사항</a></li>\n</ul>\n</li>\n<li><a href=\"/SpringSecurity1/#%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%8F-%EC%9A%94%EC%B2%AD-%EC%BA%90%EC%8B%9C-%ED%95%84%ED%84%B0\">예외 처리 및 요청 캐시 필터</a></li>\n<li><a href=\"/SpringSecurity1/#csrf%EC%B2%98%EB%A6%AC\">CSRF처리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/SpringSecurity1/#%EC%A3%BC%EC%9A%94-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\">주요 아키텍처</a></p>\n<ul>\n<li><a href=\"/SpringSecurity1/#delegatingfilterproxy\">DelegatingFilterProxy</a></li>\n<li><a href=\"/SpringSecurity1/#filterchainproxy\">FilterChainProxy</a></li>\n<li><a href=\"/SpringSecurity1/#filter-%EC%B4%88%EA%B8%B0%ED%99%94-%EB%8B%A4%EC%A4%91-%EB%B3%B4%EC%95%88-%EC%84%A4%EC%A0%95\">Filter 초기화 다중 보안 설정</a></li>\n<li>\n<p><a href=\"/SpringSecurity1/#%EC%9D%B8%EC%A6%9Dauthentication\">인증(Authentication)</a></p>\n<ul>\n<li><a href=\"/SpringSecurity1/#securitycontext\">SecurityContext</a></li>\n<li><a href=\"/SpringSecurity1/#securitycontextholder\">SecurityContextHolder</a></li>\n<li><a href=\"/SpringSecurity1/#securitypersistencefilter\">SecurityPersistenceFilter</a></li>\n<li><a href=\"/SpringSecurity1/#%EC%9D%B8%EC%A6%9D-%ED%9D%90%EB%A6%84-authentication-flow\">인증 흐름 (Authentication Flow)</a></li>\n<li><a href=\"/SpringSecurity1/#authenticationmanager\">AuthenticationManager</a></li>\n<li><a href=\"/SpringSecurity1/#authenticationprovider\">AuthenticationProvider</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/SpringSecurity1/#%EC%9D%B8%EA%B0%80authorization\">인가(Authorization)</a></p>\n<ul>\n<li><a href=\"/SpringSecurity1/#%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0%EA%B0%80-%EC%A7%80%EC%9B%90%ED%95%98%EB%8A%94-%EA%B6%8C%ED%95%9C-%EA%B3%84%EC%B8%B5\">시큐리티가 지원하는 권한 계층</a></li>\n<li><a href=\"/SpringSecurity1/#authorizationfilter\">AuthorizationFilter</a></li>\n<li><a href=\"/SpringSecurity1/#accessdecisionmanager\">AccessDecisionManager</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/SpringSecurity1/#%EC%A0%95%EB%A6%AC-1\">정리</a></p>\n<ul>\n<li><a href=\"/SpringSecurity1/#%EC%B4%88%EA%B8%B0%ED%99%94\">초기화</a></li>\n<li><a href=\"/SpringSecurity1/#%EC%9D%B8%EC%A6%9D\">인증</a></li>\n<li><a href=\"/SpringSecurity1/#%EC%9D%B8%EA%B0%80\">인가</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/SpringSecurity1/#reference\">Reference</a></li>\n</ul>","fields":{"slug":"/SpringSecurity1/"},"frontmatter":{"title":"Spring Security Session","date":"Jan 14, 2023","tags":["Spring"],"keywords":["Spring","Security"],"update":"Jan 19, 2023"}}},"pageContext":{"slug":"/SpringSecurity1/","series":[],"lastmod":"2023-01-19"}},"staticQueryHashes":["2027115977","694178885"]}