{"componentChunkName":"component---src-templates-post-tsx","path":"/phpNginxCI_2/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"nginx\" style=\"position:relative;\"><a href=\"#nginx\" aria-label=\"nginx permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nginx</h1>\n<h2 id=\"cgicommon-gateway-interface-란\" style=\"position:relative;\"><a href=\"#cgicommon-gateway-interface-%EB%9E%80\" aria-label=\"cgicommon gateway interface 란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CGI(Common Gateway Interface) 란?</h2>\n<blockquote>\n<p>웹서버와 외부 프로그램(C, PHP, Python 등) 사이에서 정보를 주고받는 방법과 규약</p>\n</blockquote>\n<p><strong>이 표준에 맞춰 만들어진 것이 CGI 스크립트이다.</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/abdcdb62b17eececa456b7423a7a9360/b3ad9/cgipic.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtklEQVQoz41TS6uBURQ9P80/M5EMDGSCEZKJUgwYCAMTJRHK+/1+5U3e67Z2HX3undxdX+dor73X2utsKhAIwGKxwOfzQcf7/f6cr9fr6zPmdIzHYwyHQ9RqNSiPx4NsNotwOIzZbPYBGwt+hzE3n8/RarVwPB7R6/WgcrkckskkeG63W6zX6w+Y93a7jW63i06ng9FohOfzKTmqXSwWUkNMo9GQUzG5Wq3weDwEuN/v5WOhw+FAJBJBLBZDIpGA3W5HtVr9KLter3I/HA5YLpdyKpfLBZvNBrfbLbIJIpiM0WhUfnMkEnKKTCYjyjabjeRIzlGpvlKpQPn9fhQKBcTjcQGyKcHFYlEeisw0nIXEUO10OhXcbreT6Tgq84PBAKrZbCKdTkt3bTibcORQKCTKTSYTzGYzvF4vJpMJbrfbl9f0ly/MqZQ2lUw0muz3+12AbJrP52G1WhEMBkW5DvpFaxgkOJ1OuFwuUDTe6XSKEu6TbqYfi2Ocz2fxkUpIoteGDVhDQTxLpRIU969cLiOVSgnLf/dQ5zUZ1dNr1e/3ZSXq9fqfpdWF+h9jbGS8swfXiY1/AFodJZZ7lcu/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cgipic\"\n        title=\"cgipic\"\n        src=\"/static/abdcdb62b17eececa456b7423a7a9360/fcda8/cgipic.png\"\n        srcset=\"/static/abdcdb62b17eececa456b7423a7a9360/12f09/cgipic.png 148w,\n/static/abdcdb62b17eececa456b7423a7a9360/e4a3f/cgipic.png 295w,\n/static/abdcdb62b17eececa456b7423a7a9360/fcda8/cgipic.png 590w,\n/static/abdcdb62b17eececa456b7423a7a9360/efc66/cgipic.png 885w,\n/static/abdcdb62b17eececa456b7423a7a9360/b3ad9/cgipic.png 909w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"관련-용어\" style=\"position:relative;\"><a href=\"#%EA%B4%80%EB%A0%A8-%EC%9A%A9%EC%96%B4\" aria-label=\"관련 용어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관련 용어</h3>\n<ul>\n<li>Web Server : 웹 클라이언트에게 콘텐츠를 제공하는 서버</li>\n<li>WAS : 서버 단에서 Application을 동작할 수 있도록 지원</li>\n</ul>\n<h3 id=\"장점\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90\" aria-label=\"장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장점</h3>\n<ul>\n<li>언어, 플랫폼에 독립적</li>\n<li>매우 단순하고 다른 서버 사이드 프로그래밍 언어에 비해 쉽게 수행</li>\n<li>라이브러리가 풍부하다</li>\n<li>가볍다</li>\n</ul>\n<h3 id=\"단점\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90\" aria-label=\"단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h3>\n<ul>\n<li>\n<p>느리다(요청이 올 때 마다 DB connection을 새로 열어야 한다)</p>\n<!-- TODO : 확인해보자 -->\n</li>\n<li>HTTP 요청마다 <strong>새로운 프로세스를 만들어</strong> 서버 메모리를 사용한다 (Fork로 구현되어 있음)</li>\n<li>데이터가 메모리에 캐시될 수 없다.</li>\n</ul>\n<h3 id=\"추가\" style=\"position:relative;\"><a href=\"#%EC%B6%94%EA%B0%80\" aria-label=\"추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>추가</h3>\n<p><a href=\"https://tools.ietf.org/html/rfc3875#section-1.4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RPC 3875-1.4 항목</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1. CGI 프로그램을 호출하는 WEB 서버 역할\n  1) 전송 단계에서의 인증 및 보안\n  2) CGI 프로그램의 선택\n  3) CGI Request 로 변환\n  4) CGI Response에서의 변환\n2. 호출 프로그램의 지정 방법 (URI)\n3. WEB 서버에서 CGI Request의 해석 방법 (경로 및 프로토콜)\n4. WEB 서버에서 CGI Response에 대한 반환 방법 (경로 및 프로토콜)</code></pre></div>\n<h2 id=\"fastcgi란\" style=\"position:relative;\"><a href=\"#fastcgi%EB%9E%80\" aria-label=\"fastcgi란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FastCGI란?</h2>\n<blockquote>\n<p>하나의 큰 프로세스로 동작한다. 이 프로세스가 계속해서 새로운 요청(Request) 처리(CGI 단점 해결)</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/07073fa1645db47fbd224fc6a09fe2d3/b3ad9/fastcgip.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABl0lEQVQoz4VSx6oCQRCcD/PL/ACPnrwogqwHHx68KLsmBDOirgExIkYMiwETKqZ6dsOIyJPX0MxMT3VNdU8Ls9kMm82G6/UKssfjwX673XC/39nlnuISI89yL88in88jkUhgOBxy8D+TpN9MlMplzGYzVjgejzl4PB4RiUSgqirC4TCv2Wz2lXS5XNDr9VjEaDRCu91Go9HAZDKB0DQNxWKRgafTCZvNhi8VRWFAvV5HpVKB0+nE4XBg3H6/RzqdZlIiy+VyyGQySCaTEC6XCz8eDyevVitWS4o8zxiRFQoFxGIxuN1uxiwWC177/T47qZVGwgSVlkql+IJ6uF6vUavV4HA44Pf7WVkgEIDdbudWkG23WwwGA8znc27T+XzmOP2HWC6Xr1eMJ4DKIeLpdAqLxQKTyQSfz8etkEbEpJxIm80mOp0Out0uqtUqhNVqhdfrhWEYr6Tdbgdd1xlMCqh0SqDxkT/darUQjUb5jiqickmMiMfjCAaD3L+/xkLO2vsMyr184B0rQqEQys9f/Ez+5p+kn/e/WTrelWaa030AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fastcgip\"\n        title=\"fastcgip\"\n        src=\"/static/07073fa1645db47fbd224fc6a09fe2d3/fcda8/fastcgip.png\"\n        srcset=\"/static/07073fa1645db47fbd224fc6a09fe2d3/12f09/fastcgip.png 148w,\n/static/07073fa1645db47fbd224fc6a09fe2d3/e4a3f/fastcgip.png 295w,\n/static/07073fa1645db47fbd224fc6a09fe2d3/fcda8/fastcgip.png 590w,\n/static/07073fa1645db47fbd224fc6a09fe2d3/efc66/fastcgip.png 885w,\n/static/07073fa1645db47fbd224fc6a09fe2d3/b3ad9/fastcgip.png 909w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>대부분의 웹서버 <strong>(Nginx, IIS, Apache)</strong> 가 FastCGI를 제공한다.</p>\n<h2 id=\"php-fpmfast-process-manager\" style=\"position:relative;\"><a href=\"#php-fpmfast-process-manager\" aria-label=\"php fpmfast process manager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP-FPM(Fast Process Manager)</h2>\n<blockquote>\n<p>PHP를 FastCGI 모드로 동작하게 해준다.</p>\n</blockquote>\n<h2 id=\"1-역할\" style=\"position:relative;\"><a href=\"#1-%EC%97%AD%ED%95%A0\" aria-label=\"1 역할 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 역할</h2>\n<ol>\n<li>정적 파일을 처리하는 <strong>HTTP 서버</strong>로서의 역할</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8adb94e382071ee630fc427dfadd8e04/8c76f/webserver.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABxklEQVQoz42ST28SURTF+TBuXfrR3NiNexfGjbrQpkpiNKahlLSAQISkqdUaQKTFARmGmYHyhin/ih2G6czPB9iGUhae5CRz35t33n3n3NBY1ZgoCsvwg4DgH2dY/r6ul9eX90PxYpzi8SZG/5LeH/fWwZmw78/ozxmsinAbs7XQx47Ni9M6eb1P6lebw0YXRQwZux53EAR36unUxXUnXHmL/0MRrcezgk7R7JGuCmLlFu++a2x9VYmftCh3RvzIF2hpxrwjR140mXp4srBtm1QiSnI/gq7VF4InsfdsR95QtS84kt1lqx32pNDbbyqP9ko8/HDIvQf3ebz1EqXn8UUV5I1zMjWLZEEh92mXeGxbCqoLwUE2gxrfIS/G5GqCnZ8m4eMGzw9qPPlc4XXmlI1MmI1KFKOhU5EBNjQNpd6grjXJpfdJJ3YxDW0h6EeTTMIRDqSHicoZKUWQ/d2l1B4wcKY3dl1KrzpnHUzTZDQacSEZyKA86d3Mv5uUjwyLzbJOQT6j1LSo6W2azSbnlpACbRzH4X8xT/mV7fHUusIZjxn2ewwHfYQQWN0uwrJkgu7amVvHeYfzUVgdhzU3rw746rBf4y+qhuqYA+pigwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"webserver\"\n        title=\"webserver\"\n        src=\"/static/8adb94e382071ee630fc427dfadd8e04/fcda8/webserver.png\"\n        srcset=\"/static/8adb94e382071ee630fc427dfadd8e04/12f09/webserver.png 148w,\n/static/8adb94e382071ee630fc427dfadd8e04/e4a3f/webserver.png 295w,\n/static/8adb94e382071ee630fc427dfadd8e04/fcda8/webserver.png 590w,\n/static/8adb94e382071ee630fc427dfadd8e04/8c76f/webserver.png 612w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"2\">\n<li>응용 프로그램 서버에 요청을 보내는 <strong>리버스 프록시</strong> 역할</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 538px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a44021d65e8c8560a553b7286dbfc734/9516f/reverseProxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABRElEQVQoz5WS207CQBCGef+HMF74AmajiTEBgxcYlVOrKbQVRKi2Xei2DRt6/i2LtOXgaW9md+af3W9mp4Z/rizLCrvdV2O1vyZ9t3fmFoyJWpxrVVGapgdJZXJ2QOU4c8idJtR+HXy53FxYJdonrK40LX1BEIAxhuFwgNurMzzdXyIKw13COI6hKApc1xXnycyBPDAwnrKchOFV68GYvmCxcGBZFjjnQjfSh6D2R9nD7YVrESEE3U4bnPbhvXfBjB58s4/n9jV0+QbSYwNLvvrxw75KhsAn5By6piEOeV7CCkkc5rEUvYcm6uQEI1UWtKZpikqiKILLKExjjG2XCsIkSUCpJexO7/I4pRS2bcPzPEGx1vi+D11XocgtaFLj9085NmelduP38wcaF6eQ7gjCMDgcm/1ZOzY++zpVkTB7GxfaT8cyBHrVNixPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"reverseProxy\"\n        title=\"reverseProxy\"\n        src=\"/static/a44021d65e8c8560a553b7286dbfc734/9516f/reverseProxy.png\"\n        srcset=\"/static/a44021d65e8c8560a553b7286dbfc734/12f09/reverseProxy.png 148w,\n/static/a44021d65e8c8560a553b7286dbfc734/e4a3f/reverseProxy.png 295w,\n/static/a44021d65e8c8560a553b7286dbfc734/9516f/reverseProxy.png 538w\"\n        sizes=\"(max-width: 538px) 100vw, 538px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>프록시는, <strong>클라이언트와 서버 통신 사이에서 통신을 대신!! 해주는 서버를 의미한다.</strong></p>\n<h3 id=\"리버스-프록시란\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EB%B2%84%EC%8A%A4-%ED%94%84%EB%A1%9D%EC%8B%9C%EB%9E%80\" aria-label=\"리버스 프록시란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리버스 프록시란?</h3>\n<blockquote>\n<p>클라이언트가 서버에 요청하면, 프록시 서버가 배후 서버(응용프로그램 서버)로부터 데이터를 가져옴</p>\n</blockquote>\n<p>추가로 포워드 프록시는 클라이언트 앞단에서\n<strong>보안을 위해 사용을 제한할 목적</strong></p>\n<p>리버스 프록시는 서버의 앞단에서 요청을 처리<br>\n<strong>좀 더 안전하게 Request, Response를 관리</strong></p>\n<h3 id=\"리버스-프록시를-쓰는-이유\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EB%B2%84%EC%8A%A4-%ED%94%84%EB%A1%9D%EC%8B%9C%EB%A5%BC-%EC%93%B0%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"리버스 프록시를 쓰는 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리버스 프록시를 쓰는 이유</h3>\n<blockquote>\n<p><strong>프록시 서버를 둠으로써 요청을 배분하는 역할</strong>\ncli가 직접 App 서버에 요청하면 프로세스 1개가 응답대기 상태가 되어서 요청에 대한 버퍼링이 생김\n추가로 <strong>보안</strong> 때문이다. -> WAS는 대부분 DB서버와 연결되어 있으므로 WS - WAS가 통신을 통해 클라이언트에게 제공하는 방식</p>\n</blockquote>\n<p>추가로 스위치(로드밸런서)로써 역할도 가능하다.</p>\n<blockquote>\n<p>프로세스 응답 대기를 막고, 요청을 배분하는 역할 </p>\n</blockquote>\n<h3 id=\"event-driven-방식\" style=\"position:relative;\"><a href=\"#event-driven-%EB%B0%A9%EC%8B%9D\" aria-label=\"event driven 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event-driven 방식</h3>\n<p>Thread 기반은 하나의 커넥션당 하나의 쓰레드를 사용</p>\n<p>Event-driven 방식은 Event Handler를 통해 비동기 방식으로 처리해 먼저 처리되는 것부터 로직이 진행된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ddf80552509d0d55c94bd9d42a422342/27b7a/threadp.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.810810810810814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABIUlEQVQoz2VRCW6EMAzk//8Ctm+otBKVCl2ucgRCzuk4sJW6tWTC2M547GRKKTRNg7Zt8Xg8oLVGiBHRGATrEP2RPATGGA+MR2vPmghEt4NBOO/h6Zl8hEQIh2HAOI5Q+w5Hcjt8I6o7wvqBwwRY72DrGq7vcTj+24A4vyNun5iWDUqtyHDZuq7oug47yaSJE4XppGJvYUQVsT2oNpHZv3nWJ4VCJqMIWVVVUMuSEoaqHS+aXZ94P/FxNfyPORWbJMIQAnqOMZNsGUZoJrd5hqEaTeUJTzMsVWjWvOKDzbdpSvWZqBOTbmI1d1QUBUr6xKKWu8wFlyVmNvniA+Z5nvBCsubCb7dbqv8lfJqolf3Y6yUFy8WFSp9Y9iX5+IIl/wPwmhxpCcFDUwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"threadp\"\n        title=\"threadp\"\n        src=\"/static/ddf80552509d0d55c94bd9d42a422342/fcda8/threadp.png\"\n        srcset=\"/static/ddf80552509d0d55c94bd9d42a422342/12f09/threadp.png 148w,\n/static/ddf80552509d0d55c94bd9d42a422342/e4a3f/threadp.png 295w,\n/static/ddf80552509d0d55c94bd9d42a422342/fcda8/threadp.png 590w,\n/static/ddf80552509d0d55c94bd9d42a422342/27b7a/threadp.png 804w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a5a87ed1c2ebb17d8edc3a52861b07dc/3cd52/eventp.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.78378378378378%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABLElEQVQoz01R2W6DMBDM/39WFNKmaaTmra+lKtBAuAwGX0xnXRKx0mDWXs/OrHe32w1lWaKqKuR5jmmagGVB8B5LcP9gHuH4L/uPPBjWBoQQYi6xm+cZdV1HQiFvug7+foeraiz6G8uQwlgPRyKbF/BNg9laOCK0n/C6RN10MOSJhPLp+x5ZlmEcR1gWemMwa41p7KCHFkopKNYokqm2xTAMmHhuph7WaN5xUWUkFKlS0LJQ7Cr+KxIrjsEYS3WENOCZW+1KPNZtyF5UqNlNVGpeKn4y/BKGexLW0R5nJyEqxIFALnsZwyZ/WvZr54aWXo5HHPZ7VJyrzPb1dMLb+Rxt50WBhOfvl0t085WmOCQJPq7X6OJpeSs5CNZ5SNGdDySNtqoeryrrNpf4AzIxHZpG4qI1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"eventp\"\n        title=\"eventp\"\n        src=\"/static/a5a87ed1c2ebb17d8edc3a52861b07dc/fcda8/eventp.png\"\n        srcset=\"/static/a5a87ed1c2ebb17d8edc3a52861b07dc/12f09/eventp.png 148w,\n/static/a5a87ed1c2ebb17d8edc3a52861b07dc/e4a3f/eventp.png 295w,\n/static/a5a87ed1c2ebb17d8edc3a52861b07dc/fcda8/eventp.png 590w,\n/static/a5a87ed1c2ebb17d8edc3a52861b07dc/3cd52/eventp.png 857w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"2-파일-구조\" style=\"position:relative;\"><a href=\"#2-%ED%8C%8C%EC%9D%BC-%EA%B5%AC%EC%A1%B0\" aria-label=\"2 파일 구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 파일 구조</h2>\n<p>5개 폴더 및 파일을 알아보고 넘어가겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">conf.d : nginx.conf에서 불러들일 수 있는 파일을 저장\nfastcgi.conf : FastCGI 환경설정 파일\nnginx.conf : 접속자 수, 동작 프로세스 수 등 퍼포먼스에 관한 설정들\nsites-available : 비활성화된 사이트들의 설정 파일들이 위치한다.\nsites-enabled : 활성화된 사이트들의 설정 파일들이 위치한다. </code></pre></div>\n<p>사실 기본 설정이 이렇다는 거고, 폴더명 같은 경우는 상황에 따라 변경이 가능하다. </p>\n<h2 id=\"3-변수\" style=\"position:relative;\"><a href=\"#3-%EB%B3%80%EC%88%98\" aria-label=\"3 변수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 변수</h2>\n<h4 id=\"arg_parameter\" style=\"position:relative;\"><a href=\"#arg_parameter\" aria-label=\"arg_parameter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$arg_{PARAMETER}</h4>\n<blockquote>\n<p>URI의 파라미터 변수의 이름 의미</p>\n</blockquote>\n<h4 id=\"host\" style=\"position:relative;\"><a href=\"#host\" aria-label=\"host permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$host</h4>\n<blockquote>\n<p>현재 요청의 호스트 명</p>\n</blockquote>\n<h4 id=\"uri\" style=\"position:relative;\"><a href=\"#uri\" aria-label=\"uri permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$uri</h4>\n<blockquote>\n<p>현재 요청의 URI (호스트명과 파라미터는 제외된다.)</p>\n</blockquote>\n<h4 id=\"args\" style=\"position:relative;\"><a href=\"#args\" aria-label=\"args permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$args</h4>\n<blockquote>\n<p>URL의 질의 문자열</p>\n</blockquote>\n<h4 id=\"binaryremoteaddr\" style=\"position:relative;\"><a href=\"#binaryremoteaddr\" aria-label=\"binaryremoteaddr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$binary<em>remote</em>addr</h4>\n<blockquote>\n<p>바이너리 형식의 클라이언트 주소</p>\n</blockquote>\n<h4 id=\"bodybytessent\" style=\"position:relative;\"><a href=\"#bodybytessent\" aria-label=\"bodybytessent permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$body<em>bytes</em>sent</h4>\n<blockquote>\n<p>전송된 바디의 바이트 수</p>\n</blockquote>\n<h4 id=\"content_length\" style=\"position:relative;\"><a href=\"#content_length\" aria-label=\"content_length permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$content_length</h4>\n<blockquote>\n<p>HTTP 요청헤더의 Content-length</p>\n</blockquote>\n<h4 id=\"content_type\" style=\"position:relative;\"><a href=\"#content_type\" aria-label=\"content_type permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$content_type</h4>\n<blockquote>\n<p>HTTP 요청헤더의 Content-type</p>\n</blockquote>\n<h4 id=\"document_root\" style=\"position:relative;\"><a href=\"#document_root\" aria-label=\"document_root permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$document_root</h4>\n<blockquote>\n<p>현재 요청의 document root 값</p>\n</blockquote>\n<h4 id=\"http_header\" style=\"position:relative;\"><a href=\"#http_header\" aria-label=\"http_header permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$http_HEADER</h4>\n<blockquote>\n<p>HTTP 헤더의 값을 소문자로 한 값(-는 _로 변환된다.)</p>\n</blockquote>\n<h4 id=\"server_name--server_port--server_protocol\" style=\"position:relative;\"><a href=\"#server_name--server_port--server_protocol\" aria-label=\"server_name  server_port  server_protocol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>$server_name / $server_port / $server_protocol</h4>\n<blockquote>\n<p>각각 name, port, protocol을 의미한다.</p>\n</blockquote>\n<h4 id=\"cookie_쿠키이름\" style=\"position:relative;\"><a href=\"#cookie_%EC%BF%A0%ED%82%A4%EC%9D%B4%EB%A6%84\" aria-label=\"cookie_쿠키이름 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>cookie_{쿠키이름}</h4>\n<blockquote>\n<p>해당 쿠키의 값을 얻을 수 있다.</p>\n</blockquote>\n<h2 id=\"4-설정\" style=\"position:relative;\"><a href=\"#4-%EC%84%A4%EC%A0%95\" aria-label=\"4 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 설정</h2>\n<p><strong>설정 수정 시 원본을 복사해 보관해 두는 습관 가지자!</strong></p>\n<h3 id=\"설정-파일\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC\" aria-label=\"설정 파일 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설정 파일</h3>\n<p>설정파일은 크게 4가지로 나뉜다.</p>\n<ol>\n<li>nginx.conf : 메인 설정 파일</li>\n<li>fcgi.conf : FastCGI 환경 설정파일</li>\n<li>sites-enabled : 활성화된 사이트들의 설정 파일 위치</li>\n<li>sites-available : 비활성화된 사이트들의 설정 파일 위치</li>\n</ol>\n<p>두개의 파일을 보며 Nginx 설정에 대해 확인해보자</p>\n<blockquote>\n<p>/etc/nginx/nginx.conf<br>\n/etc/nginx/sites-available/default</p>\n</blockquote>\n<h4 id=\"etcnginxnginxconf\" style=\"position:relative;\"><a href=\"#etcnginxnginxconf\" aria-label=\"etcnginxnginxconf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>/etc/nginx/nginx.conf</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">user www-data;\nworker_processes auto;\npid /run/nginx.pid;\n\nevents {\n        worker_connections 768;\n        # multi_accept on; #기본값:off\n}\n\nhttp {\n        sendfile on;\n        tcp_nopush on;\n        tcp_nodelay on;\n        keepalive_timeout 10; #기본값:75\n        types_hash_max_size 2048;\n        server_tokens off;\n\n        server_names_hash_bucket_size 64; #기본값:32\n        server_names_hash_max_size 2048; #기본값:512\n        # server_name_in_redirect off;\n\n        include /etc/nginx/mime.types;\n        default_type application/octet-stream;\n\n        access_log off; log_not_found off;\n        error_log /var/log/nginx/error.log warn;\n\n        include /etc/nginx/conf.d/*.conf;\n        include /etc/nginx/sites-enabled/*;\n}</code></pre></div>\n<p>nginx.conf 파일은 접속자 수, 동작 프로세스 수 등 퍼포먼스에 대한 기본적인 설정 항목을 포함한다.</p>\n<p>크게 3가지 항목으로 나뉜다.</p>\n<h4 id=\"1-최상단-core-모듈\" style=\"position:relative;\"><a href=\"#1-%EC%B5%9C%EC%83%81%EB%8B%A8-core-%EB%AA%A8%EB%93%88\" aria-label=\"1 최상단 core 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 최상단 (Core 모듈)</h4>\n<p>user : Nginx 프로세스(워커 프로세스)가 실행되는 권한</p>\n<ul>\n<li>nginx는 master process, worker process로 동작한다.</li>\n<li>실질적으로 <strong>worker process가 실직적인 웹서버 역할</strong> 수행</li>\n<li>\n<p>root로 설정되어 있을 경우, 워커 프로세스를 root 권한으로 동작<br>\n-> 악의적인 사용자가 제어하게 된다면 보안상 위험<br>\n-> 보통 <strong>www-data, www, nginx</strong>와 같이 계정이 하는 일에 대한 대표성 있는 이름 사용  </p>\n<ul>\n<li>(default 값 - ubuntu : www-data, 기타 nobody )<br>\n-> 이 계정들은 일반 유저의 권한으로 쉘에 접속 할 수 없어야 안전하다.  </li>\n<li>\n<p>ubuntu 에서 계정 생성방법  </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">useradd</span> --shell /usr/sbin/nologin www-data</code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<p>worker_processes : Nginx 프로세스 실행 가능 수</p>\n<ul>\n<li>auto일 경우도 있지만, 명시적으로 서버의 코어 수 만큼 할당하는 것이 보통 (더 높게도 가능)</li>\n</ul>\n<p>pid : Nginx 마스터 프로세스 정보</p>\n<h4 id=\"2-events\" style=\"position:relative;\"><a href=\"#2-events\" aria-label=\"2 events permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. events</h4>\n<p>주로 네트워크의 동작 방법과 관련된 설정값을 가진다. </p>\n<p>worker_connections : 몇개의 접속을 동시에 처리할 것인가</p>\n<ul>\n<li>worker<em>processes * worker</em>connections = <strong>처리 할 수 있는 커넥션의 양</strong></li>\n<li>\n<p>Tip!!</p>\n<ul>\n<li>여러 자료와 퍼포먼스 테스트를 하며 값을 조정해야 한다.</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"3-http\" style=\"position:relative;\"><a href=\"#3-http\" aria-label=\"3 http permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. http</h4>\n<blockquote>\n<p>server, location의 루트 블록이라 할 수 있고, 여기서 설정된 값들은 하위 블록들이 상속한다.<br>\nhttp 블록은 여러개를 사용할 수 있지만 관리상의 이유로 한번 사용하는 것이 좋다.</p>\n</blockquote>\n<ul>\n<li>keepalive_timeout : 클라이언트에서 커넥션을 유지하는 시간을 의미</li>\n<li>servers token : Nginx 버전 숨길 수 있는 기능 (주석을 제거해 보안 이슈를 방지하는 것이 좋다.)</li>\n<li>server<em>names</em>hash<em>max</em>size, server<em>names</em>hash<em>bucket</em>size : 호스트의 도메인 이름에 대한 공간(너무 낮으면 에러 발생 가능)</li>\n<li><strong>log관련 설정</strong>은 각 <strong>호스트 마다 배분</strong>하는 것이 관리하기 편하므로 http block에선 off로 처리한다.</li>\n</ul>\n<h4 id=\"etc\" style=\"position:relative;\"><a href=\"#etc\" aria-label=\"etc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>etc</h4>\n<ul>\n<li><strong>include 옵션</strong> : 별도의 파일에 설정을 기록해서 설정의 그룹핑, 재활용성을 높이는 방법</li>\n<li>\n<p>ex) 리버스 프록시를 각 도메인에 설정한다고 했을 때 헤더 처리 옵션등을 conf.d에 넣어두고 불러온다. (nginx.conf 설정 파일이 깔끔해짐)</p>\n<ul>\n<li>리버스 프록시란? : </li>\n</ul>\n</li>\n</ul>\n<h4 id=\"4-server--location\" style=\"position:relative;\"><a href=\"#4-server--location\" aria-label=\"4 server  location permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. server / location</h4>\n<p>/etc/nginx/sites-available/default에 server, location 블록이 작성되어 있다.</p>\n<p>server 블록 : 하나의 웹사이트를 선언하는데 사용 (가상 호스팅 개념)\nlocation 블록 : server 블록 안에 등장하며 특정 URL을 처리한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">server {\n    listen       80;\n    server_name  localhost;\n \n    root   /usr/share/nginx/html;\n    location / {\n        index  index.html index.htm index.php;\n    }\n \n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n\n    location ~ \\.php$ {\n        fastcgi_pass   unix:/var/run/php5-fpm.sock;\n        fastcgi_index  index.php;\n        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        include        fastcgi_params;\n    }\n}</code></pre></div>\n<p>location 블록을 상세히 살펴보면</p>\n<ol>\n<li>fastcgi_pass : </li>\n<li>fastcgi_param : </li>\n</ol>\n<p><strong>설정 파일을 변경하면 nginx에 반영해야 하는데, reload 명령을 이용한다</strong></p>\n<h2 id=\"추가-1\" style=\"position:relative;\"><a href=\"#%EC%B6%94%EA%B0%80-1\" aria-label=\"추가 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>추가!!</h2>\n<ul>\n<li>보통 가상 호스트 설정 파일의 경우 sites-available 디렉토리 아래 위치  </li>\n<li>sites-enabled 디렉토리에 심볼릭 링크를 걸어주면서 nginx에서 사용하게 설정</li>\n<li>에러 같은 경우 중요한 오류 이외에는 로그로 남기지 않게 설정해서 로그로 인해 디스크 엑세스를 하지 않게 설정한다!</li>\n</ul>\n<p><strong>conf파일 구성은 상황마다 다르다.</strong></p>\n<h3 id=\"로그-파일-위치\" style=\"position:relative;\"><a href=\"#%EB%A1%9C%EA%B7%B8-%ED%8C%8C%EC%9D%BC-%EC%9C%84%EC%B9%98\" aria-label=\"로그 파일 위치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>로그 파일 위치</h3>\n<blockquote>\n<p>/var/log/nginx</p>\n</blockquote>\n<h2 id=\"upstream-module\" style=\"position:relative;\"><a href=\"#upstream-module\" aria-label=\"upstream module permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Upstream Module</h2>\n<blockquote>\n<p>NGINX를 일종의 LoadBalancer(부하분산, 속도개선)로 이용할 수 있게 해주는 모듈</p>\n</blockquote>\n<ul>\n<li>conf파일의 upstream블록을 통해 사용한다. </li>\n<li>was를 의미하고, nginx는 downstream에 해당한다고 할 수 있다.</li>\n</ul>\n<p><strong>형식</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">upstream 이름 {\n    [ip_hash;]\n    server host 주소:포트 [옵션];\n    .....\n}</code></pre></div>\n<p><strong>예제</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">upstream backend {\n    ip_hash;\n    server 192.168.125.142:9000 weight=3;\n    server 192.168.125.143:9000;\n    server 192.168.125.144:9000 max_fails=5 fail_timeout=30s;\n    server unix:/var/run/php5-fpm.sock backup;\n}</code></pre></div>\n<p><strong>옵션</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ip_hash : 같은 방문자로부터 도착한 요청은 항상 같은 업스트림 서버가 처리하게 설정\nweight=n : 업스트림 서버의 비중(2 -&gt; 2배 더 자주 사용)\nmax_fails=n : n으로 지정한 횟수만큼 실패가 일어나면 서버가 죽은 것으로 간주한다.\nfail_timeout=n : max_fails가 지정된 상태에서 이 값이 설정만큼 서버가 응답하지 않으면 죽은 것으로 간주한다.\ndown : 해당 서버를 사용하지 않게 지정한다. ip_hash; 지시어가 설정된 상태에서만 유효하다.\nbackup : 모든 서버가 동작하지 않을 때 backup으로 표시된 서버가 사용되고 그 전까지는 사용되지 않는다.</code></pre></div>\n<p>다음 사진과 같이 사용한다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/90ed54ffa789de99de5f0405f68a29cd/6a6e9/upstream.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABmUlEQVQoz6VTaU/CQBDtf/dP+AOMH/0BokIEonK0Qgk0kQLlSrl72nN57ozBeGAicZO3051u3xxvqiAH/FaE1+AVWZbB930EwseeXsh9LyT2f4dCm2n1oWkaBoMB9LaO4aWN8ELyLXHyUmjzXA/FYhHlchlqU4V5PcbD2TO6jwZ23habzQau68JxHLZBEGC9XvOZKiKf53nsZ0LHc5hM7+iwJhaa3Tpqdw3UG9LWarAsC9PplDGfz2HbNkzTZP9sNmM/WQqiiFwgWIUIwxDRMgEWMsCL7OMo4shJkpxWskgFYL4fRMAy/LgkhPjAofmfn7+IslyusNjZcAyZ1blU/EogS7Kj0emDgz0GznC73aGh1qHdtuDcxHArsRyhCEmacLkEakee578G+FIyOVVVxXNHQ9OQIuiPLE6pVEK1WuXGD4dDxHH8I7tjpAr1gmaw3Wrj6eEJlfsKnwuFAo8SqWcYBnq9Hvr9PkajEQcglQ9ZfyZVoijCZDLhcSD5Dx/QkI/HY7YEIqN7lAD9UUR2LEslTVP8Z30v+Q1oDpRy7bRLcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"upstream\"\n        title=\"upstream\"\n        src=\"/static/90ed54ffa789de99de5f0405f68a29cd/fcda8/upstream.png\"\n        srcset=\"/static/90ed54ffa789de99de5f0405f68a29cd/12f09/upstream.png 148w,\n/static/90ed54ffa789de99de5f0405f68a29cd/e4a3f/upstream.png 295w,\n/static/90ed54ffa789de99de5f0405f68a29cd/fcda8/upstream.png 590w,\n/static/90ed54ffa789de99de5f0405f68a29cd/6a6e9/upstream.png 826w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"재작성rewrite\" style=\"position:relative;\"><a href=\"#%EC%9E%AC%EC%9E%91%EC%84%B1rewrite\" aria-label=\"재작성rewrite permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>재작성(rewrite)</h2>\n<blockquote>\n<p>rewrite 모듈을 통해 URL 재작성</p>\n</blockquote>\n<p>예제</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">location ~ /tutorials/javascript.html {\n    rewrite ^ http://opentutorials.org/course/48;\n}</code></pre></div>\n<p>리다이렉션을 디버깅 하기 위해선 <strong>error_log 지시자를 server나 location블록 아래에 위치!!</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">server {\n    server_name opentutorials.org\n    error_log /var/log/opentutorials.org.error debug;\n    location ~ /.php$ {\n        error_log /var/log/opentutorials.org.php.error debug;\n    }\n}</code></pre></div>\n<p>위와 같이 사용하면 error log는 debug수준에서 출력 -> 에러 출력 debug레벨 사용</p>\n<p>www를 제거하는 예제</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">if ($host ~* ^www\\.(.*)){\n    set $host_without_www $1;\n    rewrite ^/(.*)$ $scheme://$host_without_www/$1 permanent;\n}</code></pre></div>","excerpt":"Nginx CGI(Common Gateway Interface) 란? 웹서버와 외부 프로그램(C, PHP, Python 등) 사이에서 정보를 주고받는 방법과 규약 이 표준에 맞춰 만들어진 것이 CGI 스크립트이다.  관련 용어 Web Server :…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/phpNginxCI_2/#nginx\">Nginx</a></p>\n<ul>\n<li>\n<p><a href=\"/phpNginxCI_2/#cgicommon-gateway-interface-%EB%9E%80\">CGI(Common Gateway Interface) 란?</a></p>\n<ul>\n<li><a href=\"/phpNginxCI_2/#%EA%B4%80%EB%A0%A8-%EC%9A%A9%EC%96%B4\">관련 용어</a></li>\n<li><a href=\"/phpNginxCI_2/#%EC%9E%A5%EC%A0%90\">장점</a></li>\n<li><a href=\"/phpNginxCI_2/#%EB%8B%A8%EC%A0%90\">단점</a></li>\n<li><a href=\"/phpNginxCI_2/#%EC%B6%94%EA%B0%80\">추가</a></li>\n</ul>\n</li>\n<li><a href=\"/phpNginxCI_2/#fastcgi%EB%9E%80\">FastCGI란?</a></li>\n<li><a href=\"/phpNginxCI_2/#php-fpmfast-process-manager\">PHP-FPM(Fast Process Manager)</a></li>\n<li>\n<p><a href=\"/phpNginxCI_2/#1-%EC%97%AD%ED%95%A0\">1. 역할</a></p>\n<ul>\n<li><a href=\"/phpNginxCI_2/#%EB%A6%AC%EB%B2%84%EC%8A%A4-%ED%94%84%EB%A1%9D%EC%8B%9C%EB%9E%80\">리버스 프록시란?</a></li>\n<li><a href=\"/phpNginxCI_2/#%EB%A6%AC%EB%B2%84%EC%8A%A4-%ED%94%84%EB%A1%9D%EC%8B%9C%EB%A5%BC-%EC%93%B0%EB%8A%94-%EC%9D%B4%EC%9C%A0\">리버스 프록시를 쓰는 이유</a></li>\n<li><a href=\"/phpNginxCI_2/#event-driven-%EB%B0%A9%EC%8B%9D\">Event-driven 방식</a></li>\n</ul>\n</li>\n<li><a href=\"/phpNginxCI_2/#2-%ED%8C%8C%EC%9D%BC-%EA%B5%AC%EC%A1%B0\">2. 파일 구조</a></li>\n<li><a href=\"/phpNginxCI_2/#3-%EB%B3%80%EC%88%98\">3. 변수</a></li>\n<li>\n<p><a href=\"/phpNginxCI_2/#4-%EC%84%A4%EC%A0%95\">4. 설정</a></p>\n<ul>\n<li><a href=\"/phpNginxCI_2/#%EC%84%A4%EC%A0%95-%ED%8C%8C%EC%9D%BC\">설정 파일</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/phpNginxCI_2/#%EC%B6%94%EA%B0%80-1\">추가!!</a></p>\n<ul>\n<li><a href=\"/phpNginxCI_2/#%EB%A1%9C%EA%B7%B8-%ED%8C%8C%EC%9D%BC-%EC%9C%84%EC%B9%98\">로그 파일 위치</a></li>\n</ul>\n</li>\n<li><a href=\"/phpNginxCI_2/#upstream-module\">Upstream Module</a></li>\n<li><a href=\"/phpNginxCI_2/#%EC%9E%AC%EC%9E%91%EC%84%B1rewrite\">재작성(rewrite)</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/phpNginxCI_2/"},"frontmatter":{"title":"Nginx 학습","date":"Feb 24, 2021","tags":["Nginx"],"keywords":["Nginx"],"update":"Mar 01, 2021"}}},"pageContext":{"slug":"/phpNginxCI_2/","series":[{"slug":"/phpNginxCI_1/","title":"PHP + Nginx 개발 환경 설정","num":1},{"slug":"/phpNginxCI_2/","title":"Nginx 학습","num":2},{"slug":"/phpNginxCI_3/","title":"PHP 기본 문법 정리","num":3},{"slug":"/phpNginxCI_4/","title":"Codeigniter 학습","num":4}],"lastmod":"2021-03-01"}},"staticQueryHashes":["2027115977","694178885"]}